<!-- IMPORTANT: Ne pas modifier ce fichier directement, mais modifier le fichier '/doc/laravel.md', puis export sur ce fichier - Éventuellent, juste remettre ici ce commentaire, et modifier dans le 'head', le 'title' de la page -->

<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Mémo Laravel</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.8.0/styles/default.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.2/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.17.2/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.2/dist/index.js"></script><script>(r => {
                setTimeout(r);
              })(() => {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"Mon CMS","children":[{"content":"Base","children":[{"content":"1 / Base Laravel","children":[{"content":"<em>composer  create-project laravel/laravel moncms --prefer-dist</em>","children":[],"payload":{"lines":"8,9"}},{"content":"Paramètres .env file (APP_NAME, APP_URL &amp; DB_DATABASE)","children":[],"payload":{"lines":"9,10"}},{"content":"Ajout Fr : <em>composer require --dev laravel-lang/common<br>\nphp artisan lang:update</em>","children":[],"payload":{"lines":"10,13"}}],"payload":{"lines":"6,7","fold":1}},{"content":"2 / Gestion des Models et Tables","children":[{"content":"Tables:","children":[{"content":"Migration seule : <em>php artisan make:migration create_nnn_table</em>","children":[],"payload":{"lines":"16,17"}},{"content":"Factory : <em>php artisan make:factory MmmFactory</em>","children":[],"payload":{"lines":"17,18"}},{"content":"Seeders : <em>php artisan make:seeder MmmSeeder</em>","children":[],"payload":{"lines":"18,19"}},{"content":"Penser à appeler les seeders dans database/seeders/DataBaseSeeder.php:<br>\n<em>$this-&gt;call([<br>\nMmm1Seeder::class,<br>\nMmm2Seeder::class,<br>\netc...]);</em>","children":[],"payload":{"lines":"19,24"}},{"content":"Puis les exécuter : <em>php artisan db:seed</em>","children":[],"payload":{"lines":"24,25"}}],"payload":{"lines":"15,25","fold":1}},{"content":"Models + migration :","children":[{"content":"Migrations","children":[{"content":"<em>php artisan make:model Mmm --migration</em> ou<br>\n<em>php artisan make:model Mmm -m</em>","children":[],"payload":{"lines":"27,29"}},{"content":"<em>php artisan migrate</em> la 1ère fois","children":[],"payload":{"lines":"29,30"}},{"content":"<em>php artisan migrate:refresh --seed</em> ensuite","children":[],"payload":{"lines":"30,31"}}],"payload":{"lines":"26,31"}},{"content":"Model (Mmm) :","children":[{"content":"<em>protected $timestamps = false;</em>","children":[],"payload":{"lines":"32,33"}},{"content":"<em>protected $fillable = ['name', 'email', 'password', 'role', 'valid'];</em>","children":[],"payload":{"lines":"33,34"}}],"payload":{"lines":"31,34"}},{"content":"Relations :","children":[{"content":"1:n :","children":[{"content":"(1) : Dans MmmN","children":[{"content":"<em>use Illuminate\\Database\\Eloquent\\Relations\\BelongsTo;</em>","children":[],"payload":{"lines":"37,38"}},{"content":"<em>public function Mmm1(): BelongsTo {<br>\nreturn $this-&gt;belongsTo(Mmm1::class);}</em>","children":[],"payload":{"lines":"38,40"}}],"payload":{"lines":"36,40"}},{"content":"(n) : Dans Mmm1","children":[{"content":"<em>use Illuminate\\Database\\Eloquent\\Relations\\HasMany;</em>","children":[],"payload":{"lines":"41,42"}},{"content":"<em>public function MmmN(): HasMany {<br>\nreturn $this-&gt;HasMany(MmmN::class);}</em>","children":[],"payload":{"lines":"42,45"}}],"payload":{"lines":"40,45"}}],"payload":{"lines":"35,45"}}],"payload":{"lines":"34,45"}}],"payload":{"lines":"25,45","fold":1}}],"payload":{"lines":"13,14","fold":1}},{"content":"3 / Divers","children":[{"content":"\n<p data-lines=\"47,48\">helpers:</p>","children":[{"content":"app/helpers.php (Y écrire les fonctions appelées souvent un peu n'importe où)","children":[],"payload":{"lines":"49,50"}},{"content":"Dans composer.json :<br>\n<em>\"autoload\": {<br>\n\"files\": [<br>\n\"app/helpers.php\"<br>\n],...},</em>","children":[],"payload":{"lines":"50,55"}}],"payload":{"lines":"47,55"}},{"content":"\n<p data-lines=\"55,56\"><em>composer dumpautoload</em></p>","children":[],"payload":{"lines":"55,57"}}],"payload":{"lines":"45,46","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-donnees\">https://laravel.sillo.org/posts/mon-cms-les-donnees</a></strong></em>","children":[],"payload":{"lines":"57,58"}}],"payload":{"lines":"4,5","fold":1}},{"content":"Technos FrontEnd","children":[{"content":"MaryUI","children":[{"content":"<em>composer require robsontenorio/mary</em>","children":[],"payload":{"lines":"63,64"}},{"content":"<em>php artisan mary:install</em>","children":[{"content":"Doc MaryUI <a href=\"https://mary-ui.com\">https://mary-ui.com</a>","children":[],"payload":{"lines":"65,67"}}],"payload":{"lines":"64,67"}}],"payload":{"lines":"61,62","fold":1}},{"content":"Volt","children":[{"content":"Une vue Volt (Dans /route/web.php) :<br>\n<em>Volt::route('/<em>url</em>', 'dossier(s).fichier')-&gt;name('dossier.fichier');</em>","children":[],"payload":{"lines":"73,75"}},{"content":"Un nouveau composant Volt :<br>\n<em>php artisan make:volt dossier/fichier</em> --class","children":[{"content":"Class PHP","children":[],"payload":{"lines":"77,78"}},{"content":"Template Blade","children":[],"payload":{"lines":"78,79"}}],"payload":{"lines":"75,79"}},{"content":"À utiliser pour faire register / login / forgot-password<br>\n(En pensant aussi à faire les routes correspondantes)","children":[],"payload":{"lines":"79,82"}}],"payload":{"lines":"71,72","fold":1}},{"content":"Référence: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-lauthentification\">https://laravel.sillo.org/posts/mon-cms-lauthentification</a></strong></em>","children":[],"payload":{"lines":"82,83"}}],"payload":{"lines":"59,60","fold":1}},{"content":"FrontEnd","children":[{"content":"index (HomePage)","children":[{"content":"Image","children":[{"content":"<em>php artisan storage:link</em><br>\n(Lien symbolique de public/storage vers storage/app/public)","children":[],"payload":{"lines":"90,93"}}],"payload":{"lines":"88,89"}},{"content":"Référence: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-la-page-daccueil\">https://laravel.sillo.org/posts/mon-cms-la-page-daccueil</a></strong></em>","children":[],"payload":{"lines":"93,94"}}],"payload":{"lines":"86,87","fold":1}},{"content":"Les articles","children":[{"content":"posts/show","children":[],"payload":{"lines":"97,98"}},{"content":"Dynamic Title/Description/Keywords (S.E.O.)","children":[{"content":"<strong>Layout:</strong>","children":[{"content":"<pre data-lines=\"103,104\"><code>- title :\n</code></pre>","children":[],"payload":{"lines":"103,104"}},{"content":"<pre><code class=\"language-php\">  &lt;title&gt;{{ (<span class=\"hljs-keyword\">isset</span>(<span class=\"hljs-variable\">$title</span>) ? <span class=\"hljs-variable\">$title</span> . <span class=\"hljs-string\">' | '</span> :\n  (<span class=\"hljs-title class_\">View</span>::<span class=\"hljs-title function_ invoke__\">hasSection</span>(<span class=\"hljs-string\">'title'</span>) ? <span class=\"hljs-title class_\">View</span>::<span class=\"hljs-title function_ invoke__\">getSection</span>(<span class=\"hljs-string\">'title'</span>) . <span class=\"hljs-string\">' | '</span> :\n   <span class=\"hljs-string\">''</span>)) . <span class=\"hljs-title function_ invoke__\">config</span>(<span class=\"hljs-string\">'app.name'</span>) }}&lt;/title&gt;\n  &lt;meta name=<span class=\"hljs-string\">\"description\"</span> content=<span class=\"hljs-string\">\"@yield('description')\"</span>&gt;\n  &lt;meta name=<span class=\"hljs-string\">\"keywords\"</span> content=<span class=\"hljs-string\">\"@yield('keywords')\"</span>&gt;*\n</code></pre>","children":[]}],"payload":{"lines":"101,102"}},{"content":"<strong>Vue</strong> (Blade):","children":[{"content":"<pre><code class=\"language-php\">@php\n  <span class=\"hljs-variable\">$title</span>=<span class=\"hljs-string\">'TitrePage'</span>\n@endphp\n</code></pre>","children":[]},{"content":"<pre data-lines=\"119,120\"><code>ou :\n</code></pre>","children":[],"payload":{"lines":"119,120"}},{"content":"<pre><code class=\"language-php\">@<span class=\"hljs-title function_ invoke__\">section</span>(<span class=\"hljs-string\">'title'</span>, <span class=\"hljs-variable\">$post</span>-&gt;seo_title ?? <span class=\"hljs-variable\">$post</span>-&gt;title)\n@<span class=\"hljs-title function_ invoke__\">section</span>(<span class=\"hljs-string\">'description'</span>, <span class=\"hljs-variable\">$post</span>-&gt;meta_description)\n@<span class=\"hljs-title function_ invoke__\">section</span>(<span class=\"hljs-string\">'keywords'</span>, <span class=\"hljs-variable\">$post</span>-&gt;meta_keywords\n</code></pre>","children":[]}],"payload":{"lines":"112,113"}}],"payload":{"lines":"99,100","fold":1}},{"content":"Plugin prose de Tailwind","children":[{"content":"<em>npm install -D @tailwindcss/typography</em>","children":[],"payload":{"lines":"128,129"}},{"content":"exports default {<br>\n&nbsp;&nbsp;...<br>\n&nbsp;&nbsp;plugins: [<br>\n&nbsp;&nbsp;&nbsp;&nbsp;plugins: [require(\"@tailwindcss/typography\"), require(\"daisyui\")],<br>\n&nbsp;&nbsp;],<br>\n}","children":[],"payload":{"lines":"129,135"}},{"content":"<em>&lt;div class=\"relative items-center w-full py-5 mx-auto prose md:px-12 max-w-7xl\"&gt;</em>","children":[],"payload":{"lines":"135,137"}}],"payload":{"lines":"126,127","fold":1}},{"content":"Librairie prismjs","children":[{"content":"Configure prism.css et prism.js : <a href=\"https://prismjs.com/download.html\">https://prismjs.com/download.html</a>","children":[],"payload":{"lines":"139,140"}},{"content":"Poser dans layout:<br>\n...<br>\n&lt;head&gt;<br>\n...<br>\n&nbsp;&nbsp;<em><strong>&lt;link rel=\"stylesheet\" href=\"{{ asset('storage/css/prism.css') }}\"&gt;</strong></em><br>\n&lt;/head&gt;<br>\n&lt;body class=\"min-h-screen font-sans antialiased bg-base-200/50 dark:bg-base-200\"&gt;<br>\n...<br>\n&nbsp;&nbsp;<em><strong>&lt;script src=\"{{ asset('storage/scripts/prism.js') }}\"&gt;</strong></em><br>\n&lt;/body&gt;","children":[],"payload":{"lines":"140,151"}}],"payload":{"lines":"137,138","fold":1}},{"content":"Mode clair/sombre (MaryIU)","children":[{"content":"\n<p data-lines=\"153,158\">tailwind.config.js :<br>\n<em>export default {<br>\n...<br>\n&nbsp;&nbsp;darkMode: 'class',<br>\n}</em></p>","children":[],"payload":{"lines":"153,159"}},{"content":"\n<p data-lines=\"159,163\">navigation/navbar.blade.php :<br>\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;x-theme-toggle title=\"{{ __('Toggle theme') }}\" class=\"w-4 h-8\" /&gt;<br>\n&nbsp;&nbsp;&lt;/x-slot:actions&gt;<br>\n&lt;/x-nav&gt;</p>","children":[],"payload":{"lines":"159,164"}},{"content":"\n<p data-lines=\"164,165\">Doc MaryUI <em><strong><a href=\"https://mary-ui.com/docs/components/theme-toggle\">https://mary-ui.com/docs/components/theme-toggle</a></strong></em></p>","children":[],"payload":{"lines":"164,166"}}],"payload":{"lines":"151,152","fold":1}},{"content":"Search bar","children":[{"content":"Composant search","children":[{"content":"<pre data-lines=\"170,171\"><code>(PHP (La logique)\n</code></pre>","children":[],"payload":{"lines":"170,171"}},{"content":"<pre><code class=\"language-bash\">  use Livewire\\Attributes\\Validate;\n  use Livewire\\Volt\\Component;\n  \n  new class() extends Component {\n  \n      <span class=\"hljs-comment\">#[Validate('required|string|max:100')]</span>\n      public string <span class=\"hljs-variable\">$search</span> = <span class=\"hljs-string\">''</span>;\n  \n      public <span class=\"hljs-keyword\">function</span> <span class=\"hljs-function\"><span class=\"hljs-title\">save</span></span>() {\n      <span class=\"hljs-variable\">$data</span> = <span class=\"hljs-variable\">$this</span>-&gt;validate();\n  \n      <span class=\"hljs-built_in\">return</span> redirect(<span class=\"hljs-string\">'/search/'</span> . <span class=\"hljs-variable\">$data</span>[<span class=\"hljs-string\">'search'</span>]);\n      }\n  };\n</code></pre>","children":[]},{"content":"<pre data-lines=\"189,190\"><code>HTML (Blade) pour La Vue)\n</code></pre>","children":[],"payload":{"lines":"189,190"}},{"content":"<pre><code class=\"language-bash\">  &lt;div&gt;\n    &lt;form wire:submit.prevent=<span class=\"hljs-string\">\"save\"</span>&gt;\n    &lt;x-input placeholder=<span class=\"hljs-string\">\"{{ __('Search') }}...\"</span> wire:model=<span class=\"hljs-string\">\"search\"</span> clearable icon=<span class=\"hljs-string\">\"o-magnifying-glass\"</span> /&gt;\n    &lt;/form&gt;\n  &lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"168,169","fold":1}},{"content":"Traduction nécessaire (<strong>fr.json</strong>)","children":[{"content":"<strong>\"Search...\": \"Rechercher...\",</strong>","children":[],"payload":{"lines":"201,203"}}],"payload":{"lines":"199,200","fold":1}},{"content":"La route (route/web.php)","children":[{"content":"<pre><code class=\"language-bash\">*Volt::route(<span class=\"hljs-string\">'/search/{param}'</span>, <span class=\"hljs-string\">'index'</span>)-&gt;name(<span class=\"hljs-string\">'posts.search'</span>);*\n</code></pre>","children":[]}],"payload":{"lines":"203,204","fold":1}},{"content":"Ajouter dans app/Repositories/PostRepository.php","children":[{"content":"<pre data-lines=\"213,214\"><code>La fonction qui inclue la chaîne du formulaire pour gérer la recherche :\n</code></pre>","children":[],"payload":{"lines":"213,214"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">search</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$search</span></span>): <span class=\"hljs-title\">LengthAwarePaginator</span> </span>{\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">getBaseQuery</span>()\n      -&gt;<span class=\"hljs-title function_ invoke__\">latest</span>()\n      -&gt;<span class=\"hljs-title function_ invoke__\">where</span>(function (<span class=\"hljs-variable\">$query</span>) <span class=\"hljs-keyword\">use</span> ($<span class=\"hljs-title\">search</span>) {\n      $<span class=\"hljs-title\">query</span>-&gt;<span class=\"hljs-title\">where</span>('<span class=\"hljs-title\">title</span>', '<span class=\"hljs-title\">like</span>', \"%{$<span class=\"hljs-title\">search</span>}%\")\n        -&gt;<span class=\"hljs-title\">orWhere</span>('<span class=\"hljs-title\">body</span>', '<span class=\"hljs-title\">like</span>', \"%{$<span class=\"hljs-title\">search</span>}%\");\n      })\n      -&gt;<span class=\"hljs-title function_ invoke__\">paginate</span>(<span class=\"hljs-title function_ invoke__\">config</span>(<span class=\"hljs-string\">'app.pagination'</span>));\n  }\n</code></pre>","children":[]}],"payload":{"lines":"211,212","fold":1}},{"content":"Composant index (Homepage (Page d'accueil))","children":[{"content":"<strong>Bloc PHP</strong> : Quand on récupère les posts","children":[{"content":"<pre data-lines=\"231,233\"><code>(function getPosts()), on déclenche le composant search\nsi l'URI comporte un paramètre) :\n</code></pre>","children":[],"payload":{"lines":"231,233"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-keyword\">empty</span>(<span class=\"hljs-variable language_\">$this</span>-&gt;param)) {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$postRepository</span>-&gt;<span class=\"hljs-title function_ invoke__\">search</span>(<span class=\"hljs-variable\">$this</span>-&gt;param);\n}\n</code></pre>","children":[]}],"payload":{"lines":"229,230"}},{"content":"<strong>Bloc Vue Blade</strong> : S'il y a une recherche","children":[{"content":"<pre data-lines=\"242,243\"><code>Alors, on affiche le titre de la page adapté :\n</code></pre>","children":[],"payload":{"lines":"242,243"}},{"content":"<pre><code class=\"language-php\">    @<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable\">$category</span>)\n        &lt;x-header title=<span class=\"hljs-string\">\"{{ __('Posts for category ') }} {{ <span class=\"hljs-subst\">$category</span>-&gt;title }}\"</span> size=<span class=\"hljs-string\">\"text-2xl sm:text-3xl md:text-4xl\"</span> /&gt;\n    @<span class=\"hljs-keyword\">elseif</span>(<span class=\"hljs-variable\">$param</span> !== <span class=\"hljs-string\">''</span>)\n        &lt;x-header title=<span class=\"hljs-string\">\"{{ __('Posts for search ') }} '{{ <span class=\"hljs-subst\">$param</span> }}'\"</span> size=<span class=\"hljs-string\">\"text-2xl sm:text-3xl md:text-4xl\"</span> /&gt;\n    @<span class=\"hljs-keyword\">endif</span>\n</code></pre>","children":[]},{"content":"<pre data-lines=\"252,253\"><code>Traduction: \n</code></pre>","children":[],"payload":{"lines":"252,253"}},{"content":"<pre><code class=\"language-php\">    <span class=\"hljs-string\">\"Posts for search \"</span>: <span class=\"hljs-string\">\"Articles pour la recherche \"</span>,\n</code></pre>","children":[]}],"payload":{"lines":"240,241"}}],"payload":{"lines":"227,228","fold":1}},{"content":"Vue HTML - navigation/navbar.php","children":[{"content":"<pre><code class=\"language-php\">      &lt;x-theme-toggle title=\"{{ __('Toggle theme') }}\" class=\"w-4 h-8\" /&gt;\n      &lt;livewire:search /&gt;\n  &lt;/x-slot:actions&gt;\n&lt;/x-nav&gt;\n</code></pre>","children":[]}],"payload":{"lines":"258,259","fold":1}}],"payload":{"lines":"166,167","fold":1}},{"content":"Référence: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-articles\">https://laravel.sillo.org/posts/mon-cms-les-articles</a></strong></em>","children":[],"payload":{"lines":"267,268"}}],"payload":{"lines":"95,96","fold":1}},{"content":"Les menus (Gérés par Backoffice)","children":[{"content":"Les données","children":[{"content":"Les tables + migrations + Models + seeders :","children":[{"content":"<pre data-lines=\"274,275\"><code>Menu, Submenu, Footer\n</code></pre>","children":[],"payload":{"lines":"274,275"}}],"payload":{"lines":"273,274"}}],"payload":{"lines":"271,272"}},{"content":"Composant frontend","children":[{"content":"Nouveauté : AppServiceProvider","children":[{"content":"<pre data-lines=\"279,280\"><code>Comme appelé systématiquement \n</code></pre>","children":[],"payload":{"lines":"279,280"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">boot</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">void</span>\n    </span>{\n        <span class=\"hljs-title class_\">Facades\\View</span>::<span class=\"hljs-title function_ invoke__\">composer</span>([<span class=\"hljs-string\">'components.layouts.app'</span>], function (View <span class=\"hljs-variable\">$view</span>) {\n\t\t\t<span class=\"hljs-variable\">$view</span>-&gt;<span class=\"hljs-title function_ invoke__\">with</span>(\n\t\t\t\t<span class=\"hljs-string\">'menus'</span>,\n\t\t\t\t<span class=\"hljs-title class_\">Menu</span>::<span class=\"hljs-title function_ invoke__\">with</span>([<span class=\"hljs-string\">'submenus'</span> =&gt; function (<span class=\"hljs-variable\">$query</span>) {\n\t\t\t\t\t<span class=\"hljs-variable\">$query</span>-&gt;<span class=\"hljs-title function_ invoke__\">orderBy</span>(<span class=\"hljs-string\">'order'</span>);\n\t\t\t\t}])-&gt;<span class=\"hljs-title function_ invoke__\">orderBy</span>(<span class=\"hljs-string\">'order'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">get</span>()\n\t\t\t);\n\t\t});\n    }\n</code></pre>","children":[]}],"payload":{"lines":"278,279"}},{"content":"Dans layout","children":[{"content":"<pre data-lines=\"296,297\"><code>layouts/app.blade.php\n</code></pre>","children":[],"payload":{"lines":"296,297"}},{"content":"<pre><code class=\"language-php\">&lt;livewire:navigation.navbar :<span class=\"hljs-variable\">$menus</span> /&gt;\n...\n&lt;livewire:navigation.sidebar :<span class=\"hljs-variable\">$menus</span> /&gt;\n</code></pre>","children":[]}],"payload":{"lines":"294,295"}},{"content":"Barre de Navigation","children":[{"content":"navbar.blade.php","children":[{"content":"<pre data-lines=\"307,308\"><code>Bloc PHP\n</code></pre>","children":[],"payload":{"lines":"307,308"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Support</span>\\<span class=\"hljs-title\">Collection</span>;\n\n<span class=\"hljs-keyword\">new</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Component</span> </span>{\n    \n    <span class=\"hljs-keyword\">public</span> Collection <span class=\"hljs-variable\">$menus</span>;\n\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">mount</span>(<span class=\"hljs-params\">Collection <span class=\"hljs-variable\">$menus</span></span>): <span class=\"hljs-title\">void</span>\n    </span>{\n        <span class=\"hljs-variable language_\">$this</span>-&gt;menus = <span class=\"hljs-variable\">$menus</span>;\n    }\n</code></pre>","children":[]},{"content":"<pre data-lines=\"322,323\"><code>Bloc Blade\n</code></pre>","children":[],"payload":{"lines":"322,323"}},{"content":"<pre><code class=\"language-php\">    @foreach ($menus as $menu)\n        @if ($menu-&gt;submenus-&gt;isNotEmpty())\n            &lt;x-dropdown&gt;\n                &lt;x-slot:trigger&gt;\n                    &lt;x-button label=\"{{ $menu-&gt;label }}\" class=\"btn-ghost\" /&gt;\n                &lt;/x-slot:trigger&gt;\n                @foreach ($menu-&gt;submenus as $submenu)\n                    &lt;x-menu-item title=\"{{ $submenu-&gt;label }}\" link=\"{{ $submenu-&gt;link }}\"\n                        style=\"min-width: max-content;\" /&gt;\n                @endforeach\n            &lt;/x-dropdown&gt;\n        @else\n            &lt;x-button label=\"{{ $menu-&gt;label }}\" link=\"{{ $menu-&gt;link }}\" :external=\"Str::startsWith($menu-&gt;link, 'http')\"\n                class=\"btn-ghost\" /&gt;\n        @endif\n    @endforeach\n</code></pre>","children":[]}],"payload":{"lines":"306,307","fold":1}},{"content":"sidebar.blade.php","children":[{"content":"<pre data-lines=\"344,345\"><code>navigation/sidebar.blade.php\n</code></pre>","children":[],"payload":{"lines":"344,345"}},{"content":"<pre><code class=\"language-php\">    ...\n\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Support</span>\\<span class=\"hljs-title\">Collection</span>;\n\n<span class=\"hljs-keyword\">new</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Component</span> </span>{\n\n    <span class=\"hljs-keyword\">public</span> Collection <span class=\"hljs-variable\">$menus</span>;\n\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">mount</span>(<span class=\"hljs-params\">Collection <span class=\"hljs-variable\">$menus</span></span>): <span class=\"hljs-title\">void</span>\n    </span>{\n        <span class=\"hljs-variable language_\">$this</span>-&gt;menus = <span class=\"hljs-variable\">$menus</span>;\n    }\n\n    ...\n\n};\n\n    ...\n&lt;x-menu activate-by-route&gt;\n    \n    ...\n\n    @<span class=\"hljs-keyword\">foreach</span> (<span class=\"hljs-variable\">$menus</span> <span class=\"hljs-keyword\">as</span> <span class=\"hljs-variable\">$menu</span>)\n        @<span class=\"hljs-keyword\">if</span>(<span class=\"hljs-variable\">$menu</span>-&gt;submenus-&gt;<span class=\"hljs-title function_ invoke__\">isNotEmpty</span>())\n            &lt;x-menu-sub title=<span class=\"hljs-string\">\"{{ <span class=\"hljs-subst\">$menu</span>-&gt;label }}\"</span>&gt;\n                @<span class=\"hljs-keyword\">foreach</span> (<span class=\"hljs-variable\">$menu</span>-&gt;submenus <span class=\"hljs-keyword\">as</span> <span class=\"hljs-variable\">$submenu</span>)\n                    &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ <span class=\"hljs-subst\">$submenu</span>-&gt;label }}\"</span> link=<span class=\"hljs-string\">\"{{ <span class=\"hljs-subst\">$submenu</span>-&gt;link }}\"</span> /&gt;\n                @<span class=\"hljs-keyword\">endforeach</span>\n            &lt;/x-menu-sub&gt;\n        @<span class=\"hljs-keyword\">else</span>\n            &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ <span class=\"hljs-subst\">$menu</span>-&gt;label }}\"</span> link=<span class=\"hljs-string\">\"{{ <span class=\"hljs-subst\">$menu</span>-&gt;link }}\"</span> /&gt;\n        @<span class=\"hljs-keyword\">endif</span>\n    @<span class=\"hljs-keyword\">endforeach</span>\n&lt;/x-menu&gt;\n</code></pre>","children":[]}],"payload":{"lines":"343,344","fold":1}}],"payload":{"lines":"304,305"}},{"content":"Menu Pied de page","children":[{"content":"navigation/footer.php","children":[{"content":"<pre data-lines=\"386,387\"><code>Composant\n</code></pre>","children":[],"payload":{"lines":"386,387"}},{"content":"<pre><code class=\"language-php\">&lt;?php\n\nuse App\\Models\\Footer;\nuse Livewire\\Volt\\Component;\n\nnew class() extends Component {\n\n\tpublic function with(): array\n\t{\n\t\treturn [\n\t\t\t'footers' =&gt; Footer::orderBy('order')-&gt;get(),\n\t\t];\n\t}\n};\n?&gt;\n\n&lt;footer class=\"p-10 rounded footer footer-center bg-base-200 text-base-content\"&gt;\n    &lt;nav class=\"grid grid-flow-col gap-4\"&gt;\n        @foreach ($footers as $footer)\n            &lt;a href=\"{{ $footer-&gt;link }}\" class=\"link link-hover\"&gt;\n                @lang($footer-&gt;label)\n            &lt;/a&gt;\n        @endforeach\n    &lt;/nav&gt;\n    &lt;nav&gt;\n        &lt;div class=\"grid grid-flow-col gap-4\"&gt;\n            &lt;a href=\" \"\" title=\"Github\"\n            target=\"_blank\"&gt;\n                &lt;svg \n                    xmlns=\"http://www.w3.org/2000/svg\" \n                    width=\"24\" \n                    height=\"24\" \n                    viewBox=\"0 0 24 24\"\n                    class=\"fill-current\"&gt;\n                    &lt;path\n                        d=\"M12 0C5.372 0 0 5.372 0 12c0 5.303 3.438 9.8 8.207 11.387.6.11.793-.26.793-.577v-2.2c-3.338.726-4.033-1.415-4.033-1.415-.546-1.387-1.333-1.757-1.333-1.757-1.089-.744.083-.729.083-.729 1.204.085 1.838 1.237 1.838 1.237 1.07 1.835 2.809 1.305 3.495.998.108-.775.419-1.305.762-1.605-2.665-.305-5.466-1.335-5.466-5.93 0-1.31.467-2.38 1.235-3.22-.124-.303-.535-1.523.117-3.176 0 0 1.008-.322 3.3 1.23.957-.266 1.98-.399 3-.405 1.02.006 2.043.139 3 .405 2.29-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.873.118 3.176.77.84 1.233 1.91 1.233 3.22 0 4.61-2.804 5.62-5.475 5.92.43.37.815 1.1.815 2.22v3.293c0 .319.192.694.801.576C20.565 21.796 24 17.302 24 12c0-6.628-5.372-12-12-12z\" /&gt;\n                &lt;/svg&gt;\n            &lt;/a&gt;\n            &lt;a href=\" \"\"\n                title=\"Discord\"\n                target=\"_blank\"&gt;\n                &lt;svg \n                    width=\"25\" \n                    height=\"28\" \n                    viewBox=\"0 0 71 80\" \n                    class=\"fill-current mt-[-.05rem]\"\n                    xmlns=\"http://www.w3.org/2000/svg\"&gt;\n                    &lt;path\n                        d=\"M60.1045 13.8978C55.5792 11.8214 50.7265 10.2916 45.6527 9.41542C45.5603 9.39851 45.468 9.44077 45.4204 9.52529C44.7963 10.6353 44.105 12.0834 43.6209 13.2216C38.1637 12.4046 32.7345 12.4046 27.3892 13.2216C26.905 12.0581 26.1886 10.6353 25.5617 9.52529C25.5141 9.44359 25.4218 9.40133 25.3294 9.41542C20.2584 10.2888 15.4057 11.8186 10.8776 13.8978C10.8384 13.9147 10.8048 13.9429 10.7825 13.9795C1.57795 27.7309 -0.943561 41.1443 0.293408 54.3914C0.299005 54.4562 0.335386 54.5182 0.385761 54.5576C6.45866 59.0174 12.3413 61.7249 18.1147 63.5195C18.2071 63.5477 18.305 63.5139 18.3638 63.4378C19.7295 61.5728 20.9469 59.6063 21.9907 57.5383C22.0523 57.4172 21.9935 57.2735 21.8676 57.2256C19.9366 56.4931 18.0979 55.6 16.3292 54.5858C16.1893 54.5041 16.1781 54.304 16.3068 54.2082C16.679 53.9293 17.0513 53.6391 17.4067 53.3461C17.471 53.2926 17.5606 53.2813 17.6362 53.3151C29.2558 58.6202 41.8354 58.6202 53.3179 53.3151C53.3935 53.2785 53.4831 53.2898 53.5502 53.3433C53.9057 53.6363 54.2779 53.9293 54.6529 54.2082C54.7816 54.304 54.7732 54.5041 54.6333 54.5858C52.8646 55.6197 51.0259 56.4931 49.0921 57.2228C48.9662 57.2707 48.9102 57.4172 48.9718 57.5383C50.038 59.6034 51.2554 61.5699 52.5959 63.435C52.6519 63.5139 52.7526 63.5477 52.845 63.5195C58.6464 61.7249 64.529 59.0174 70.6019 54.5576C70.6551 54.5182 70.6887 54.459 70.6943 54.3942C72.1747 39.0791 68.2147 25.7757 60.1968 13.9823C60.1772 13.9429 60.1437 13.9147 60.1045 13.8978ZM23.7259 46.3253C20.2276 46.3253 17.3451 43.1136 17.3451 39.1693C17.3451 35.225 20.1717 32.0133 23.7259 32.0133C27.308 32.0133 30.1626 35.2532 30.1066 39.1693C30.1066 43.1136 27.28 46.3253 23.7259 46.3253ZM47.3178 46.3253C43.8196 46.3253 40.9371 43.1136 40.9371 39.1693C40.9371 35.225 43.7636 32.0133 47.3178 32.0133C50.9 32.0133 53.7545 35.2532 53.6986 39.1693C53.6986 43.1136 50.9 46.3253 47.3178 46.3253Z\" /&gt;\n                &lt;/svg&gt;\n            &lt;/a&gt;\n        &lt;/div&gt;\n    &lt;/nav&gt;\n    &lt;aside&gt;\n        &lt;p&gt;Version 0.1.0&lt;/a&gt; © {{ date('Y') }} Moi&lt;/p&gt;\n    &lt;/aside&gt;\n&lt;/footer&gt;\n</code></pre>","children":[]},{"content":"<pre data-lines=\"447,448\"><code>Dans layout\n</code></pre>","children":[],"payload":{"lines":"447,448"}},{"content":"<pre><code class=\"language-php\">{{-- FOOTER --}}\n    &lt;hr&gt;&lt;br&gt;\n    &lt;livewire:navigation.footer /&gt;\n    &lt;br&gt;\n\n    {{--  TOAST area --}}\n    &lt;x-toast /&gt;\n</code></pre>","children":[]}],"payload":{"lines":"384,385","fold":1}}],"payload":{"lines":"382,383"}}],"payload":{"lines":"276,277"}},{"content":"Référence: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-menus\">https://laravel.sillo.org/posts/mon-cms-les-menus</a></strong></em>","children":[],"payload":{"lines":"458,459"}}],"payload":{"lines":"269,270","fold":1}}],"payload":{"lines":"84,85","fold":1}},{"content":"Les commentaires","children":[{"content":"Model &amp; Migration et factory &amp; seeder","children":[{"content":"<pre><code class=\"language-php\">php artisan make:model Comment --migration\nphp artisan make:factory CommentFactory\nphp artisan make:seeder CommentSeeder\n</code></pre>","children":[]}],"payload":{"lines":"462,463","fold":1}},{"content":"PostRepository","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">getPostBySlug</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$slug</span></span>): <span class=\"hljs-title\">Post</span>\n</span>{\n\t<span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-title function_ invoke__\">with</span>(<span class=\"hljs-string\">'user:id,name'</span>, <span class=\"hljs-string\">'category'</span>)\n\t\t\t-&gt;<span class=\"hljs-title function_ invoke__\">withCount</span>(<span class=\"hljs-string\">'validComments'</span>)\n\t\t\t-&gt;<span class=\"hljs-title function_ invoke__\">whereSlug</span>(<span class=\"hljs-variable\">$slug</span>)-&gt;<span class=\"hljs-title function_ invoke__\">firstOrFail</span>();\n}\n</code></pre>","children":[]}],"payload":{"lines":"469,470","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-commentaires-1-2\">https://laravel.sillo.org/posts/mon-cms-les-commentaires-1-2</a></strong></em>","children":[],"payload":{"lines":"480,481"}},{"content":"Le formulaire","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt posts/comment-form --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"482,483","fold":1}},{"content":"Gravatar","children":[{"content":"<pre><code class=\"language-php\">composer <span class=\"hljs-keyword\">require</span> creativeorange/gravatar ~<span class=\"hljs-number\">1.0</span>\n---\n<span class=\"hljs-title class_\">Gravatar</span>::<span class=\"hljs-title function_ invoke__\">get</span>(<span class=\"hljs-string\">'email@example.com'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"488,489","fold":1}},{"content":"Notification","children":[{"content":"<pre><code class=\"language-php\">php artisan make:notification CommentCreated\nphp artisan make:notification CommentAnswerCreated\n</code></pre>","children":[]}],"payload":{"lines":"496,497","fold":1}},{"content":"Affichage des commentaires","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt posts/commentBase --class\nphp artisan make:volt posts/comment --class\n</code></pre>","children":[]}],"payload":{"lines":"503,504","fold":1}},{"content":"Sécurité // {!! $uneVariabledansDuCodeBladeQuiContient DuCodeDestinéÀLaVue !!}","children":[{"content":"<pre><code class=\"language-php\">composer <span class=\"hljs-keyword\">require</span> mews/purifier\n---\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Mews</span>\\<span class=\"hljs-title\">Purifier</span>\\<span class=\"hljs-title\">Casts</span>\\<span class=\"hljs-title\">CleanHtmlInput</span>;\n\n<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Comment</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Model</span>\n</span>{\n    ...\n\n\t<span class=\"hljs-keyword\">protected</span> <span class=\"hljs-variable\">$casts</span> = [\n\t\t<span class=\"hljs-string\">'body'</span> =&gt; <span class=\"hljs-title class_\">CleanHtmlInput</span>::<span class=\"hljs-variable language_\">class</span>,\n\t];\n</code></pre>","children":[]}],"payload":{"lines":"510,511","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-commentaires-2-2\">https://laravel.sillo.org/posts/mon-cms-les-commentaires-2-2</a></strong></em>","children":[],"payload":{"lines":"527,528"}}],"payload":{"lines":"460,461","fold":1}},{"content":"Le profil","children":[{"content":"Composant","children":[{"content":"Y coder","children":[{"content":"La logique (Bloc PHP)","children":[],"payload":{"lines":"539,540"}},{"content":"Le rendu (Bloc HTML)","children":[],"payload":{"lines":"540,542"}}],"payload":{"lines":"537,538"}}],"payload":{"lines":"531,532","fold":1}},{"content":"Ajouter les traductions","children":[],"payload":{"lines":"542,543"}},{"content":"Faire la route de ce composant","children":[{"content":"(Pensez que c'est que pour les \"autorisés\"<br>\n→ <strong>Middleware('auth')</strong>) et comme il y aura d'autre route pour \"eux\", en faire un <strong>group()</strong>","children":[],"payload":{"lines":"546,549"}}],"payload":{"lines":"544,545","fold":1}},{"content":"Enfin, ajouter les liens dans les vues adhoc","children":[{"content":"Pour les grands écrans, dans <strong>navigation.navbar</strong>","children":[],"payload":{"lines":"551,552"}},{"content":"Pour les plus petits, dans <strong>navigation.sidebar</strong>","children":[],"payload":{"lines":"552,554"}}],"payload":{"lines":"549,550","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-le-profil\">https://laravel.sillo.org/posts/mon-cms-le-profil</a></strong></em>","children":[],"payload":{"lines":"554,555"}}],"payload":{"lines":"529,530","fold":1}},{"content":"Les favoris","children":[{"content":"Fonctionnalité des Favoris","children":[{"content":"php artisan make:migration create_favorites_table","children":[],"payload":{"lines":"560,561"}},{"content":"Relation n:n (User &amp; Post)","children":[{"content":"<pre data-lines=\"564,565\"><code>Comme convention de nommage de la table pivot pas respectée (Devrait être posts_users mais est favorites), on doit préciser ce nom dans les relations BelongsToMany\n</code></pre>","children":[],"payload":{"lines":"564,565"}}],"payload":{"lines":"562,563","fold":1}},{"content":"getPostBySlug: Vérifie en plus si l'user a mis le post en favori","children":[],"payload":{"lines":"566,567"}},{"content":"Dans show.post, on affiche l'icône étoile pour favori ou pas (Le bloc PHP gère favoritePost() et unfavoritePost())","children":[],"payload":{"lines":"568,569"}},{"content":"Dans index, affichage de l'icône étoile si post favori","children":[],"payload":{"lines":"570,571"}},{"content":"Ajout de getFavoritePosts() dans PostRepository","children":[],"payload":{"lines":"572,573"}},{"content":"Dans la navigation.navbar, code pour afficher l'icône des favoris (Déjà sélectionné par l'utilisateur en cours)","children":[],"payload":{"lines":"574,575"}},{"content":"Enfin, pour afficher cette page","children":[{"content":"Ajout de la route dans <strong>routes/web.php</strong>","children":[],"payload":{"lines":"578,579"}},{"content":"Ajout du bouton dans <strong>navigation/navbar</strong>","children":[],"payload":{"lines":"579,580"}},{"content":"Dans le composant index:","children":[{"content":"On défini une nouvelle propriété $favorites","children":[],"payload":{"lines":"581,582"}},{"content":"mount() : On gère le cas où la requête est \"/favorites\" (On met la propriété favorites à true)","children":[],"payload":{"lines":"582,583"}},{"content":"getPosts() : Si la propriété favorites est à true, on appelle getFavoritePosts(auth()-&gt;user())<br>\n-Pour le HTML, on adapte le titre de la page","children":[],"payload":{"lines":"583,585"}}],"payload":{"lines":"580,585"}},{"content":"On renseigne fr.json pour ce titre","children":[],"payload":{"lines":"585,587"}}],"payload":{"lines":"576,577","fold":1}}],"payload":{"lines":"558,559","fold":1}},{"content":"Boutons pour Aller en bas et en haut","children":[{"content":"Règle CSS","children":[],"payload":{"lines":"589,590"}},{"content":"HTML des boutons","children":[],"payload":{"lines":"590,592"}}],"payload":{"lines":"587,588","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-favoris\">https://laravel.sillo.org/posts/mon-cms-les-favoris</a></strong></em>","children":[],"payload":{"lines":"592,593"}}],"payload":{"lines":"556,557","fold":1}},{"content":"L'administration","children":[{"content":"Gestion des rôles","children":[{"content":"User : Admin ou Redac","children":[{"content":"Model User","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">isAdmin</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">bool</span>\n</span>{\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">'admin'</span> === <span class=\"hljs-variable language_\">$this</span>-&gt;role;\n}\n\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">isRedac</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">bool</span>\n</span>{\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">'redac'</span> === <span class=\"hljs-variable language_\">$this</span>-&gt;role;\n}\n</code></pre>","children":[]}],"payload":{"lines":"600,601"}}],"payload":{"lines":"598,599","fold":1}},{"content":"Middlewares","children":[{"content":"<strong>admin</strong>","children":[{"content":"<pre><code class=\"language-php\">php artisan make:middleware IsAdmin\n</code></pre>","children":[]}],"payload":{"lines":"616,617"}},{"content":"Code","children":[{"content":"<pre><code class=\"language-php\">    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">handle</span>(<span class=\"hljs-params\">Request <span class=\"hljs-variable\">$request</span>, <span class=\"hljs-built_in\">Closure</span> <span class=\"hljs-variable\">$next</span></span>): <span class=\"hljs-title\">Response</span>\n    </span>{\n        <span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-title function_ invoke__\">auth</span>()-&gt;<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isAdmin</span>()) {\n            <span class=\"hljs-title function_ invoke__\">abort</span>(<span class=\"hljs-number\">403</span>);\n        }\n        \n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$next</span>(<span class=\"hljs-variable\">$request</span>);\n  }\n</code></pre>","children":[]}],"payload":{"lines":"622,623"}},{"content":"<strong>adminOrRedac</strong>","children":[{"content":"<pre><code class=\"language-php\">php artisan make:middleware IsAdminOrRedac\n</code></pre>","children":[]}],"payload":{"lines":"635,636"}},{"content":"Code","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">handle</span>(<span class=\"hljs-params\">Request <span class=\"hljs-variable\">$request</span>, <span class=\"hljs-built_in\">Closure</span> <span class=\"hljs-variable\">$next</span></span>): <span class=\"hljs-title\">Response</span>\n</span>{\n    <span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-title function_ invoke__\">auth</span>()-&gt;<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isAdmin</span>() &amp;&amp; !<span class=\"hljs-title function_ invoke__\">auth</span>()-&gt;<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isRedac</span>()) {\n        <span class=\"hljs-title function_ invoke__\">abort</span>(<span class=\"hljs-number\">403</span>);\n    }\n    \n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$next</span>(<span class=\"hljs-variable\">$request</span>);\n}\n</code></pre>","children":[]}],"payload":{"lines":"641,642"}}],"payload":{"lines":"614,615","fold":1}}],"payload":{"lines":"596,597","fold":1}},{"content":"Tableau de Bord","children":[{"content":"SideBar","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/sidebar --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">&lt;?php\n\nuse Illuminate\\Support\\Facades\\{Auth, Session};\nuse Livewire\\Volt\\Component;\n\nnew class() extends Component {\n  public function logout(): void {\n    Auth::guard('web')-&gt;logout();\n    \n    Session::invalidate();\n    Session::regenerateToken();\n    \n    $this-&gt;redirect('/');\n  }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-menu activate-by-route&gt;\n        &lt;x-menu-separator /&gt;\n        &lt;x-list-item :item=\"Auth::user()\" value=\"name\" sub-value=\"email\" no-separator no-hover class=\"-mx-2 !-my-2 rounded\"&gt;\n            &lt;x-slot:actions&gt;\n                &lt;x-button icon=\"o-power\" wire:click=\"logout\" class=\"btn-circle btn-ghost btn-xs\"\n                    tooltip-left=\"{{ __('Logout') }}\" no-wire-navigate /&gt;\n            &lt;/x-slot:actions&gt;\n        &lt;/x-list-item&gt;\n        &lt;x-menu-separator /&gt;\n        &lt;x-menu-item title=\"{{ __('Dashboard') }}\" icon=\"s-building-office-2\" link=\"{{ route('admin') }}\" /&gt;        \n        &lt;x-menu-item icon=\"m-arrow-right-end-on-rectangle\" title=\"{{ __('Go on site') }}\" link=\"/\" /&gt;\n        &lt;x-menu-item&gt;\n            &lt;x-theme-toggle /&gt;\n        &lt;/x-menu-item&gt;\n    &lt;/x-menu&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"656,657","fold":1}},{"content":"Layout","children":[{"content":"views/layouts/admin.blade.php","children":[],"payload":{"lines":"700,701"}},{"content":"Code Layout","children":[{"content":"<pre><code class=\"language-php\">&lt;!DOCTYPE html&gt;\n&lt;html lang=\"{{ str_replace('_', '-', app()-&gt;getLocale()) }}\"&gt;\n\n&lt;head&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, viewport-fit=cover\"&gt;\n    &lt;meta name=\"csrf-token\" content=\"{{ csrf_token() }}\"&gt;\n    &lt;title&gt;{{ isset($title) ? $title . ' | ' . config('app.name') : config('app.name') }}&lt;/title&gt;\n\n    @vite(['resources/css/app.css', 'resources/js/app.js'])\n&lt;/head&gt;\n\n&lt;body class=\"min-h-screen font-sans antialiased bg-base-200/50 dark:bg-base-200\"&gt;\n\n    {{-- MAIN --}}\n    &lt;x-main full-width&gt;\n\n        {{-- SIDEBAR --}}\n        &lt;x-slot:sidebar drawer=\"main-drawer\" collapsible class=\"bg-base-100\"&gt;\n            &lt;livewire:admin.sidebar /&gt;\n        &lt;/x-slot:sidebar&gt;\n\n        &lt;x-slot:content&gt;\n            &lt;!-- Drawer toggle for \"main-drawer\" --&gt;\n            &lt;label for=\"main-drawer\" class=\"mr-3 lg:hidden\"&gt;\n                &lt;x-icon name=\"o-bars-3\" class=\"cursor-pointer\" /&gt;\n            &lt;/label&gt;\n            {{ $slot }}\n        &lt;/x-slot:content&gt;\n\n    &lt;/x-main&gt;\n\n    {{--  TOAST area --}}\n    &lt;x-toast /&gt;\n\n&lt;/body&gt;\n\n&lt;/html&gt;\n</code></pre>","children":[]}],"payload":{"lines":"702,703"}}],"payload":{"lines":"698,699","fold":1}},{"content":"Composant","children":[{"content":"CLI","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/index --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"747,748","fold":1}},{"content":"Code","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\n\nuse App\\Models\\{Comment, Page, Post, User};\nuse Illuminate\\Database\\Eloquent\\Builder;\nuse Illuminate\\Support\\Facades\\Auth;\nuse Livewire\\Attributes\\{Layout, Title};\nuse Livewire\\Volt\\Component;\nuse Mary\\Traits\\Toast;\n\nnew #[Title('Dashboard')] #[Layout('components.layouts.admin')] class extends Component {\n\tuse Toast;\n\n\tpublic array $headersPosts;\n\tpublic bool $openGlance = true;\n\n\tpublic function mount(): void\n\t{\n\t\t$this-&gt;headersPosts = [['key' =&gt; 'date', 'label' =&gt; __('Date')], ['key' =&gt; 'title', 'label' =&gt; __('Title')]];\n\t}\n\n\tpublic function deleteComment(Comment $comment): void\n\t{\n\t\t$comment-&gt;delete();\n\n\t\t$this-&gt;warning('Comment deleted', __('Good bye!'), position: 'toast-bottom');\n\t}\n\n\tpublic function with(): array\n\t{\n\t\t$user    = Auth::user();\n\t\t$isRedac = $user-&gt;isRedac();\n\t\t$userId  = $user-&gt;id;\n\n\t\treturn [\n\t\t\t'pages'          =&gt; Page::select('id', 'title', 'slug')-&gt;get(),\n\t\t\t'posts'          =&gt; Post::select('id', 'title', 'slug', 'user_id', 'created_at', 'updated_at')-&gt;when($isRedac, fn (Builder $q) =&gt; $q-&gt;where('user_id', $userId))-&gt;latest()-&gt;get(),\n\t\t\t'commentsNumber' =&gt; Comment::when($isRedac, fn (Builder $q) =&gt; $q-&gt;whereRelation('post', 'user_id', $userId))-&gt;count(),\n\t\t\t'comments'       =&gt; Comment::with('user', 'post:id,title,slug')-&gt;when($isRedac, fn (Builder $q) =&gt; $q-&gt;whereRelation('post', 'user_id', $userId))-&gt;latest()-&gt;take(5)-&gt;get(),\n\t\t\t'users'          =&gt; User::count(),\n\t\t];\n\t}\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-collapse wire:model=\"openGlance\" class=\"shadow-md\"&gt;\n        &lt;x-slot:heading&gt;\n            @lang('In a glance')\n        &lt;/x-slot:heading&gt;\n        &lt;x-slot:content class=\"flex flex-wrap gap-4\"&gt;\n\n            &lt;a href=\"#\" class=\"flex-grow\"&gt;\n                &lt;x-stat title=\"{{ __('Posts') }}\" description=\"\" value=\"{{ $posts-&gt;count() }}\" icon=\"s-document-text\"\n                    class=\"shadow-hover\" /&gt;\n            &lt;/a&gt;\n\n            @if (Auth::user()-&gt;isAdmin())\n                &lt;a href=\"#\" class=\"flex-grow\"&gt;\n                    &lt;x-stat title=\"{{ __('Pages') }}\" value=\"{{ $pages-&gt;count() }}\" icon=\"s-document\"\n                        class=\"shadow-hover\" /&gt;\n                &lt;/a&gt;\n                &lt;a href=\"#\" class=\"flex-grow\"&gt;\n                    &lt;x-stat title=\"{{ __('Users') }}\" value=\"{{ $users }}\" icon=\"s-user\"\n                        class=\"shadow-hover\" /&gt;\n                &lt;/a&gt;\n            @endif\n            &lt;a href=\"#\" class=\"flex-grow\"&gt;\n                &lt;x-stat title=\"{{ __('Comments') }}\" value=\"{{ $commentsNumber }}\" icon=\"c-chat-bubble-left\"\n                    class=\"shadow-hover\" /&gt;\n            &lt;/a&gt;\n        &lt;/x-slot:content&gt;\n    &lt;/x-collapse&gt;\n\n    &lt;br&gt;\n\n    @foreach ($comments as $comment)\n        @if (!$comment-&gt;user-&gt;valid)\n            &lt;x-alert title=\"{!! __('Comment to valid from ') . $comment-&gt;user-&gt;name !!}\" description=\"{!! $comment-&gt;body !!}\" icon=\"c-chat-bubble-left\"\n                class=\"shadow-md alert-warning\"&gt;\n                &lt;x-slot:actions&gt;\n                    &lt;x-button link=\"#\" label=\"{!! __('Show the comments') !!}\" /&gt;\n                &lt;/x-slot:actions&gt;\n            &lt;/x-alert&gt;\n            &lt;br&gt;\n        @endif\n    @endforeach\n\n    &lt;x-collapse class=\"shadow-md\"&gt;\n        &lt;x-slot:heading&gt;\n            @lang('Recent posts')\n        &lt;/x-slot:heading&gt;\n        &lt;x-slot:content&gt;\n            &lt;x-table :headers=\"$headersPosts\" :rows=\"$posts-&gt;take(5)\" striped&gt;\n                @scope('cell_date', $post)\n                    @lang('Created') {{ $post-&gt;created_at-&gt;diffForHumans() }}\n                    @if ($post-&gt;updated_at != $post-&gt;created_at)\n                        &lt;br&gt;\n                        @lang('Updated') {{ $post-&gt;updated_at-&gt;diffForHumans() }}\n                    @endif\n                @endscope\n                @scope('actions', $post)\n                    &lt;x-popover&gt;\n                        &lt;x-slot:trigger&gt;\n                            &lt;x-button icon=\"s-document-text\" link=\"{{ route('posts.show', $post-&gt;slug) }}\" spinner class=\"btn-ghost btn-sm\" /&gt;                            \n                        &lt;/x-slot:trigger&gt;\n                        &lt;x-slot:content class=\"pop-small\"&gt;\n                            @lang('Show post')\n                        &lt;/x-slot:content&gt;\n                    &lt;/x-popover&gt;\n                @endscope\n            &lt;/x-table&gt;\n        &lt;/x-slot:content&gt;\n    &lt;/x-collapse&gt;\n\n    &lt;br&gt;\n\n    &lt;x-collapse class=\"shadow-md\"&gt;\n        &lt;x-slot:heading&gt;\n            @lang('Recent Comments')\n        &lt;/x-slot:heading&gt;\n        &lt;x-slot:content&gt;\n            @foreach ($comments as $comment)\n                &lt;x-list-item :item=\"$comment\" no-separator no-hover&gt;\n                    &lt;x-slot:avatar&gt;\n                        &lt;x-avatar :image=\"Gravatar::get($comment-&gt;user-&gt;email)\"&gt;\n                            &lt;x-slot:title&gt;\n                                {{ $comment-&gt;user-&gt;name }}\n                            &lt;/x-slot:title&gt;\n                        &lt;/x-avatar&gt;\n                    &lt;/x-slot:avatar&gt;\n                    &lt;x-slot:value&gt;\n                        @lang ('in post:') {{ $comment-&gt;post-&gt;title }}\n                    &lt;/x-slot:value&gt;\n                    &lt;x-slot:actions&gt;\n                        &lt;x-popover&gt;\n                            &lt;x-slot:trigger&gt;\n                                &lt;x-button icon=\"c-eye\" link=\"#\" spinner class=\"btn-ghost btn-sm\" /&gt;                         \n                            &lt;/x-slot:trigger&gt;\n                            &lt;x-slot:content class=\"pop-small\"&gt;\n                                @lang('Edit or answer')\n                            &lt;/x-slot:content&gt;\n                        &lt;/x-popover&gt;\n                        &lt;x-popover&gt;\n                            &lt;x-slot:trigger&gt;\n                                &lt;x-button icon=\"s-document-text\" link=\"{{ route('posts.show', $comment-&gt;post-&gt;slug) }}\" spinner class=\"btn-ghost btn-sm\" /&gt;                       \n                            &lt;/x-slot:trigger&gt;\n                            &lt;x-slot:content class=\"pop-small\"&gt;\n                                @lang('Show post')\n                            &lt;/x-slot:content&gt;\n                        &lt;/x-popover&gt;\n                        &lt;x-popover&gt;\n                            &lt;x-slot:trigger&gt;\n                                &lt;x-button icon=\"o-trash\" wire:click=\"deleteComment({{ $comment-&gt;id }})\"\n                                    wire:confirm=\"{{ __('Are you sure to delete this comment?') }}\" \n                                    spinner class=\"text-red-500 btn-ghost btn-sm\" /&gt;                   \n                            &lt;/x-slot:trigger&gt;\n                            &lt;x-slot:content class=\"pop-small\"&gt;\n                                @lang('Delete')\n                            &lt;/x-slot:content&gt;\n                        &lt;/x-popover&gt;\n                    &lt;/x-slot:actions&gt;\n                &lt;/x-list-item&gt;\n                &lt;p class=\"ml-16\"&gt;{!! Str::words(nl2br($comment-&gt;body), 20, ' ...') !!}&lt;/p&gt;\n                &lt;br&gt;\n            @endforeach\n        &lt;/x-slot:content&gt;\n    &lt;/x-collapse&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"753,754","fold":1}}],"payload":{"lines":"745,746","fold":1}},{"content":"Route","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">App</span>\\<span class=\"hljs-title\">Http</span>\\<span class=\"hljs-title\">Middleware</span>\\<span class=\"hljs-title\">IsAdminOrRedac</span>;\n\n...\n\n<span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-string\">'auth'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n\t...\n\t<span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-title class_\">IsAdminOrRedac</span>::<span class=\"hljs-variable language_\">class</span>)-&gt;<span class=\"hljs-title function_ invoke__\">prefix</span>(<span class=\"hljs-string\">'admin'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n\t\t<span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/dashboard'</span>, <span class=\"hljs-string\">'admin.index'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'admin'</span>);\n\t});\n});\n</code></pre>","children":[]}],"payload":{"lines":"927,928","fold":1}},{"content":"Traductions","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"In a glance\"</span>: <span class=\"hljs-string\">\"En un coup d'oeil\"</span>,\n<span class=\"hljs-string\">\"Recent posts\"</span>: <span class=\"hljs-string\">\"Articles récents\"</span>,\n<span class=\"hljs-string\">\"Users\"</span>: <span class=\"hljs-string\">\"Utilisateurs\"</span>,\n<span class=\"hljs-string\">\"Dashboard\"</span>: <span class=\"hljs-string\">\"Tableau de bord\"</span>,\n<span class=\"hljs-string\">\"Recent Comments\"</span>: <span class=\"hljs-string\">\"Commentaires récents\"</span>,\n<span class=\"hljs-string\">\"Show post\"</span>: <span class=\"hljs-string\">\"Afficher l'article\"</span>,\n<span class=\"hljs-string\">\"in post:\"</span>: <span class=\"hljs-string\">\"dans l'article :\"</span>,\n<span class=\"hljs-string\">\"Go on site\"</span>: <span class=\"hljs-string\">\"Aller sur le site\"</span>,\n<span class=\"hljs-string\">\"Edit or answer\"</span>: <span class=\"hljs-string\">\"Modifier ou repondre\"</span>,\n<span class=\"hljs-string\">\"Posts\"</span>: <span class=\"hljs-string\">\"Articles\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"942,943","fold":1}},{"content":"Lien dans le menu","children":[{"content":"Logique (model User)","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">isAdminOrRedac</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">bool</span>\n</span>{\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">'admin'</span> === <span class=\"hljs-variable language_\">$this</span>-&gt;role || <span class=\"hljs-string\">'redac'</span> === <span class=\"hljs-variable language_\">$this</span>-&gt;role;\n}\n</code></pre>","children":[]}],"payload":{"lines":"959,960","fold":1}},{"content":"Lien dans Menu","children":[{"content":"Lien dans navigation.navbar","children":[{"content":"<pre><code class=\"language-php\">&lt;x-slot:actions&gt;\n    &lt;span class=\"hidden lg:block\"&gt;\n        @if ($user = auth()-&gt;user())\n            &lt;x-dropdown&gt;\n                ...User name\n                @if ($user-&gt;isAdminOrRedac())\n                    &lt;x-menu-item title=\"{{ __('Administration') }}\" link=\"{{ route('admin') }}\" /&gt;\n                @endif\n                &lt;x-menu-separator /&gt;\n                ... Profile\n                &lt;x-menu-separator /&gt;\n                ... Logout\n            &lt;/x-dropdown&gt;\n        @else\n</code></pre>","children":[]}],"payload":{"lines":"970,971"}},{"content":"Lien dans navigation.sidebar","children":[{"content":"<pre><code class=\"language-php\">              ... Logout\n            &lt;/x-<span class=\"hljs-keyword\">list</span>-item&gt;\n            @<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable\">$user</span>-&gt;<span class=\"hljs-title function_ invoke__\">isAdminOrRedac</span>())\n                &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('Administration') }}\"</span> icon=<span class=\"hljs-string\">\"s-building-office-2\"</span> link=<span class=\"hljs-string\">\"{{ route('admin') }}\"</span> /&gt;\n            @<span class=\"hljs-keyword\">endif</span>\n</code></pre>","children":[]}],"payload":{"lines":"989,990"}}],"payload":{"lines":"968,969","fold":1}}],"payload":{"lines":"957,958","fold":1}},{"content":"Redac &amp; Admin: Redirection lors du login","children":[{"content":"<pre data-lines=\"1002,1003\"><code>Composant auth.login :\n</code></pre>","children":[],"payload":{"lines":"1002,1003"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">login</span>(<span class=\"hljs-params\"></span>) </span>{\n    ...\n\n        <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title function_ invoke__\">auth</span>()-&gt;<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isAdmin</span>()) {\n            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_ invoke__\">redirect</span>()-&gt;<span class=\"hljs-title function_ invoke__\">intended</span>(<span class=\"hljs-string\">'/admin/dashboard'</span>);\n        }\n        ... <span class=\"hljs-keyword\">return</span>\n    \n</code></pre>","children":[]}],"payload":{"lines":"1000,1001","fold":1}}],"payload":{"lines":"654,655","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-ladministration\">https://laravel.sillo.org/posts/mon-cms-ladministration</a></strong></em>","children":[],"payload":{"lines":"1014,1015"}}],"payload":{"lines":"594,595","fold":1}},{"content":"Les articles","children":[{"content":"Tableau des articles","children":[{"content":"Composant","children":[{"content":"CLI","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/posts/index --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"1022,1023"}},{"content":"Code","children":[{"content":"Dans le composant admin.posts.index","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\n\nuse Mary\\Traits\\Toast;\nuse Livewire\\Volt\\Component;\nuse Livewire\\WithPagination;\nuse App\\Models\\{Post, Category};\nuse Illuminate\\Support\\Facades\\Auth;\nuse Livewire\\Attributes\\{Layout, Title};\nuse Illuminate\\Pagination\\LengthAwarePaginator;\nuse Illuminate\\Database\\Eloquent\\{Builder, Collection};\n\nnew \n#[Layout('components.layouts.admin'), Title('List Posts')]\nclass extends Component {\n    use Toast, WithPagination;\n\n    public string $search = '';\n    public Collection $categories;\n    public $category_id = 0;\n    public array $sortBy  = ['column' =&gt; 'created_at', 'direction' =&gt; 'desc'];\n\n    public function mount(): void {\n        $this-&gt;categories = $this-&gt;getCategories();\n    }\n\n    public function getCategories(): Collection {\n        if (Auth::user()-&gt;isAdmin()) {\n            return Category::all();\n        }\n        \n        return Category::whereHas('posts', fn (Builder $q) =&gt; $q-&gt;where('user_id', Auth::id()))-&gt;get();\n        }\n        \n    public function headers(): array {\n        $headers = [\n            ['key' =&gt; 'title', 'label' =&gt; __('Title')],\n        ];\n    \n        if (Auth::user()-&gt;isAdmin()) {\n            $headers = array_merge($headers, [['key' =&gt; 'user_name', 'label' =&gt; __('Author')]]);\n        }\n    \n        return array_merge($headers, [\n            ['key' =&gt; 'category_title', 'label' =&gt; __('Category')],\n            ['key' =&gt; 'comments_count', 'label' =&gt; __('')],\n            ['key' =&gt; 'active', 'label' =&gt; __('Published')],\n            ['key' =&gt; 'date', 'label' =&gt; __('Date')],\n      ]);\n      }\n\n    public function posts(): LengthAwarePaginator {\n        return Post::query()\n            -&gt;select('id', 'title', 'slug', 'category_id', 'active', 'user_id', 'created_at', 'updated_at')\n            -&gt;when(Auth::user()-&gt;isAdmin(), fn (Builder $q) =&gt; $q-&gt;withAggregate('user', 'name'))\n            -&gt;when(!Auth::user()-&gt;isAdmin(), fn (Builder $q) =&gt; $q-&gt;where('user_id', Auth::id()))\n            -&gt;withAggregate('category', 'title')\n            -&gt;withcount('comments')\n            -&gt;when($this-&gt;search, fn (Builder $q) =&gt; $q-&gt;where('title', 'like', \"%{$this-&gt;search}%\"))\n            -&gt;when($this-&gt;category_id, fn (Builder $q) =&gt; $q-&gt;where('category_id', $this-&gt;category_id))\n            -&gt;when('date' === $this-&gt;sortBy['column'], fn (Builder $q) =&gt; $q-&gt;orderBy('created_at', $this-&gt;sortBy['direction']), fn (Builder $q) =&gt; $q-&gt;orderBy($this-&gt;sortBy['column'], $this-&gt;sortBy['direction']))\n            -&gt;latest()\n            -&gt;paginate(6);\n    }\n\n    public function deletePost(int $postId): void {\n        $post = Post::findOrFail($postId);\n        $post-&gt;delete();\n        $this-&gt;success(\"{$post-&gt;title} \" . __('deleted'));\n    }\n\n    public function clonePost(int $postId): void {\n        $originalPost       = Post::findOrFail($postId);\n        $clonedPost         = $originalPost-&gt;replicate();\n        $postRepository     = new PostRepository();\n        $clonedPost-&gt;slug   = $postRepository-&gt;generateUniqueSlug($originalPost-&gt;slug);\n        $clonedPost-&gt;active = false;\n        $clonedPost-&gt;save();\n    \n        // Ici on redirigera vers le formulaire de modification de l'article cloné\n    }\n        \n    public function with(): array {\n        return [\n            'headers' =&gt; $this-&gt;headers(),\n            'posts'   =&gt; $this-&gt;posts(),\n        ];\n    }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header title=\"{{ __('Posts') }}\" separator progress-indicator&gt;\n        &lt;x-slot:actions&gt;\n            &lt;x-input placeholder=\"{{ __('Search...') }}\" wire:model.live.debounce=\"search\" clearable icon=\"o-magnifying-glass\" /&gt;\n            &lt;x-button label=\"{{ __('Add a post') }}\" class=\"btn-outline lg:hidden\" link=\"#\" /&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline lg:hidden\"\n                link=\"{{ route('admin') }}\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n\n    @if ($posts-&gt;count() &gt; 0)\n                &lt;x-card&gt;\n            &lt;x-table striped :headers=\"$headers\" :rows=\"$posts\" :sort-by=\"$sortBy\" link=\"#\" with-pagination&gt;\n\n                @scope('header_comments_count', $header)\n                    {{ $header['label'] }}\n                    &lt;x-icon name=\"c-chat-bubble-left\" /&gt;\n                @endscope\n\n                @scope('cell_comments_count', $post)\n                    @if ($post-&gt;comments_count &gt; 0)\n                        &lt;x-badge value=\"{{ $post-&gt;comments_count }}\" class=\"badge-primary\" /&gt;\n                    @endif\n                @endscope\n\n                @scope('cell_active', $post)\n                    @if ($post-&gt;active)\n                        &lt;x-icon name=\"o-check-circle\" /&gt;\n                    @endif\n                @endscope\n\n                @scope('cell_date', $post)\n                    @lang('Created') {{ $post-&gt;created_at-&gt;diffForHumans() }}\n                    @if ($post-&gt;updated_at != $post-&gt;created_at)\n                        &lt;br&gt;\n                        @lang('Updated') {{ $post-&gt;updated_at-&gt;diffForHumans() }}\n                    @endif\n                @endscope\n\n                @scope('actions', $post)\n                    &lt;div class=\"flex\"&gt;\n                        &lt;x-popover&gt;\n                            &lt;div class=\"flex\"&gt;\n                                &lt;x-slot:trigger&gt;\n                                    &lt;x-button icon=\"o-finger-print\" wire:click=\"clonePost({{ $post-&gt;id }})\" spinner\n                                        class=\"btn-ghost btn-sm\" /&gt;\n                                &lt;/x-slot:trigger&gt;\n                                &lt;x-slot:content class=\"pop-small\"&gt;\n                                    @lang('Clone')\n                                &lt;/x-slot:content&gt;\n                            &lt;/x-popover&gt;\n                        &lt;x-popover&gt;\n                            &lt;x-slot:trigger&gt;\n                                &lt;x-button icon=\"o-trash\" wire:click=\"deletePost({{ $post-&gt;id }})\"\n                                    wire:confirm=\"{{ __('Are you sure to delete this post?') }}\" spinner\n                                    class=\"text-red-500 btn-ghost btn-sm\" /&gt;\n                            &lt;/x-slot:trigger&gt;\n                            &lt;x-slot:content class=\"pop-small\"&gt;\n                                @lang('Delete')\n                            &lt;/x-slot:content&gt;\n                        &lt;/x-popover&gt;\n                    &lt;/div&gt;\n                @endscope\n\n            &lt;/x-table&gt;\n        &lt;/x-card&gt;\n    @endif\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1030,1031","fold":1}},{"content":"Dans le PostRepository","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">generateUniqueSlug</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$slug</span></span>): <span class=\"hljs-title\">string</span>\n</span>{\n\t<span class=\"hljs-variable\">$newSlug</span> = <span class=\"hljs-variable\">$slug</span>;\n\t<span class=\"hljs-variable\">$counter</span> = <span class=\"hljs-number\">1</span>;\n\t<span class=\"hljs-keyword\">while</span> (<span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-title function_ invoke__\">where</span>(<span class=\"hljs-string\">'slug'</span>, <span class=\"hljs-variable\">$newSlug</span>)-&gt;<span class=\"hljs-title function_ invoke__\">exists</span>()) {\n\t\t<span class=\"hljs-variable\">$newSlug</span> = <span class=\"hljs-variable\">$slug</span> . <span class=\"hljs-string\">'-'</span> . <span class=\"hljs-variable\">$counter</span>;\n\t\t++<span class=\"hljs-variable\">$counter</span>;\n\t}\n\t<span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable\">$newSlug</span>;\n}\n</code></pre>","children":[]}],"payload":{"lines":"1192,1193","fold":1}}],"payload":{"lines":"1028,1029"}},{"content":"Traductions","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Title\"</span>: <span class=\"hljs-string\">\"Titre\"</span>,\n<span class=\"hljs-string\">\"Author\"</span>: <span class=\"hljs-string\">\"Auteur\"</span>,\n<span class=\"hljs-string\">\"Updated\"</span>: <span class=\"hljs-string\">\"Mis à jour\"</span>,\n<span class=\"hljs-string\">\"Category\"</span>: <span class=\"hljs-string\">\"Catégorie\"</span>,\n<span class=\"hljs-string\">\"Published\"</span>: <span class=\"hljs-string\">\"Publié\"</span>,\n<span class=\"hljs-string\">\"Add a post\"</span>: <span class=\"hljs-string\">\"Ajouter un article\"</span>,\n<span class=\"hljs-string\">\"Are you sure to delete this post?\"</span>: <span class=\"hljs-string\">\"Êtes-vous sûr de vouloir supprimer cet article ?\"</span>,\n<span class=\"hljs-string\">\"deleted\"</span>: <span class=\"hljs-string\">\"supprimé\"</span>,\n<span class=\"hljs-string\">\"Clone\"</span>: <span class=\"hljs-string\">\"Dupliquer\"</span>,\n<span class=\"hljs-string\">\"Filters\"</span>: <span class=\"hljs-string\">\"Filtres\"</span>,\n<span class=\"hljs-string\">\"Select a category\"</span>: <span class=\"hljs-string\">\"Sélectionnez une catégorie\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"1208,1209"}}],"payload":{"lines":"1020,1021","fold":1}},{"content":"Routes","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-string\">'auth'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n\t...\n\t<span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-title class_\">IsAdminOrRedac</span>::<span class=\"hljs-variable language_\">class</span>)-&gt;<span class=\"hljs-title function_ invoke__\">prefix</span>(<span class=\"hljs-string\">'admin'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n\t\t...\n\t\t<span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/posts/index'</span>, <span class=\"hljs-string\">'admin.posts.index'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'posts.index'</span>);\n\t});\n});\n</code></pre>","children":[]}],"payload":{"lines":"1224,1225","fold":1}},{"content":"Navigation","children":[{"content":"admin/sidebar","children":[{"content":"<pre><code class=\"language-php\">... Dashboard\n&lt;x-menu-sub title=<span class=\"hljs-string\">\"{{ __('Posts') }}\"</span> icon=<span class=\"hljs-string\">\"s-document-text\"</span>&gt;\n    &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('All posts') }}\"</span> link=<span class=\"hljs-string\">\"{{ route('posts.index') }}\"</span> /&gt;\n&lt;/x-menu-sub&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1238,1239"}},{"content":"Traduction","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"All posts\"</span>: <span class=\"hljs-string\">\"Tous les articles\"</span>,\n</code></pre>","children":[]}],"payload":{"lines":"1247,1248"}}],"payload":{"lines":"1236,1237","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-tableau-des-articles\">https://laravel.sillo.org/posts/mon-cms-tableau-des-articles</a></strong></em>","children":[],"payload":{"lines":"1253,1254"}}],"payload":{"lines":"1018,1019","fold":1}},{"content":"Créer un article","children":[{"content":"Composant (Formulaire)","children":[{"content":"CLI","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/posts/create --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"1259,1260"}},{"content":"Code Création","children":[{"content":"Base","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\nuse Livewire\\Volt\\Component;\nuse App\\Models\\Category;\nuse Livewire\\Attributes\\Layout;\n\nnew #[Layout('components.layouts.admin')] \n\nclass extends Component {\n\n    public function with(): array {\n      return [\n        'categories' =&gt; Category::orderBy('title')-&gt;get(),\n    ];}\n      \n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header title=\"{{ __('Add a post') }}\" separator progress-indicator&gt;\n        &lt;x-slot:actions&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline lg:hidden\"\n                link=\"{{ route('admin') }}\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n    &lt;x-card&gt;\n        &lt;x-form wire:submit=\"save\"&gt;\n            &lt;x-select label=\"{{ __('Category') }}\" option-label=\"title\" :options=\"$categories\" wire:model=\"category_id\"\n                wire:change=\"$refresh\" /&gt;\n            &lt;br&gt;\n            &lt;div class=\"flex gap-6\"&gt;\n                &lt;x-checkbox label=\"{{ __('Published') }}\" wire:model=\"active\" /&gt;\n                &lt;x-checkbox label=\"{{ __('Pinned') }}\" wire:model=\"pinned\" /&gt;\n            &lt;/div&gt;\n            &lt;x-input type=\"text\" wire:model=\"title\" label=\"{{ __('Title') }}\"\n                placeholder=\"{{ __('Enter the title') }}\" wire:change=\"$refresh\" /&gt;\n            &lt;x-input type=\"text\" wire:model=\"slug\" label=\"{{ __('Slug') }}\" /&gt;\n            &lt;x-editor wire:model=\"body\" label=\"{{ __('Content') }}\" :config=\"config('tinymce.config')\"\n                folder=\"{{ 'photos/' . now()-&gt;format('Y/m') }}\" /&gt;\n            &lt;x-card title=\"{{ __('SEO') }}\" shadow separator&gt;\n                &lt;x-input placeholder=\"{{ __('Title') }}\" wire:model=\"seo_title\" hint=\"{{ __('Max 70 chars') }}\" /&gt;\n                &lt;br&gt;\n                &lt;x-textarea label=\"{{ __('META Description') }}\" wire:model=\"meta_description\"\n                    hint=\"{{ __('Max 160 chars') }}\" rows=\"2\" inline /&gt;\n                &lt;br&gt;\n                &lt;x-textarea label=\"{{ __('META Keywords') }}\" wire:model=\"meta_keywords\"\n                    hint=\"{{ __('Keywords separated by comma') }}\" rows=\"1\" inline /&gt;\n            &lt;/x-card&gt;\n            &lt;x-slot:actions&gt;\n                &lt;x-button label=\"{{ __('Save') }}\" icon=\"o-paper-airplane\" spinner=\"save\" type=\"submit\"\n                    class=\"btn-primary\" /&gt;\n            &lt;/x-slot:actions&gt;\n        &lt;/x-form&gt;\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1267,1268","fold":1}},{"content":"Traduction","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Select a category\"</span>: <span class=\"hljs-string\">\"Sélectionnez une catégorie\"</span>,\n<span class=\"hljs-string\">\"Pinned\"</span>: <span class=\"hljs-string\">\"Épinglé\"</span>,\n<span class=\"hljs-string\">\"Content\"</span>: <span class=\"hljs-string\">\"Contenu\"</span>,\n<span class=\"hljs-string\">\"META Keywords\"</span>: <span class=\"hljs-string\">\"META mots-clefs\"</span>,\n<span class=\"hljs-string\">\"Keywords separated by comma\"</span>: <span class=\"hljs-string\">\"Mots-clefs séparés par une virgule\"</span>,\n<span class=\"hljs-string\">\"Max 70 chars\"</span>: <span class=\"hljs-string\">\"Max 70 caractères\"</span>,\n<span class=\"hljs-string\">\"Max 160 chars\"</span>: <span class=\"hljs-string\">\"Max 160 caractères\"</span>,\n<span class=\"hljs-string\">\"Enter the title\"</span>: <span class=\"hljs-string\">\"Entrez le titre\"</span>,\n<span class=\"hljs-string\">\"Post added with success.\"</span>: <span class=\"hljs-string\">\"Article ajouté avec succès.\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"1325,1326","fold":1}},{"content":"Propriétés - Validation","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Livewire</span>\\<span class=\"hljs-title\">Attributes</span>\\{<span class=\"hljs-title\">Layout</span>, <span class=\"hljs-title\">Validate</span>};\n...\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">int</span> <span class=\"hljs-variable\">$category_id</span>;\n\n<span class=\"hljs-meta\">#[Validate</span>(<span class=\"hljs-string\">'required|string|max:16777215'</span>)<span class=\"hljs-meta\">]</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$body</span> = <span class=\"hljs-string\">''</span>;\n\n<span class=\"hljs-meta\">#[Validate</span>(<span class=\"hljs-string\">'required|string|max:255'</span>)<span class=\"hljs-meta\">]</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$title</span> = <span class=\"hljs-string\">''</span>;\n\n<span class=\"hljs-meta\">#[Validate</span>(<span class=\"hljs-string\">'required|max:255|unique:posts,slug|regex:/^[a-z0-9]+(?:-[a-z0-9]+)*$/'</span>)<span class=\"hljs-meta\">]</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$slug</span> = <span class=\"hljs-string\">''</span>;\n\n<span class=\"hljs-meta\">#[Validate</span>(<span class=\"hljs-string\">'required'</span>)<span class=\"hljs-meta\">]</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">bool</span> <span class=\"hljs-variable\">$active</span> = <span class=\"hljs-literal\">false</span>;\n\n<span class=\"hljs-meta\">#[Validate</span>(<span class=\"hljs-string\">'required'</span>)<span class=\"hljs-meta\">]</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">bool</span> <span class=\"hljs-variable\">$pinned</span> = <span class=\"hljs-literal\">false</span>;\n\n<span class=\"hljs-meta\">#[Validate</span>(<span class=\"hljs-string\">'required|max:70'</span>)<span class=\"hljs-meta\">]</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$seo_title</span> = <span class=\"hljs-string\">''</span>;\n\n<span class=\"hljs-meta\">#[Validate</span>(<span class=\"hljs-string\">'required|max:160'</span>)<span class=\"hljs-meta\">]</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$meta_description</span> = <span class=\"hljs-string\">''</span>;\n\n<span class=\"hljs-meta\">#[Validate</span>(<span class=\"hljs-string\">'required|regex:/^[A-Za-z0-9-éèàù]{1,50}?(,[A-Za-z0-9-éèàù]{1,50})*$/'</span>)<span class=\"hljs-meta\">]</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$meta_keywords</span> = <span class=\"hljs-string\">''</span>;\n\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">mount</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">void</span>\n</span>{\n    <span class=\"hljs-variable\">$category</span>          = <span class=\"hljs-title class_\">Category</span>::<span class=\"hljs-title function_ invoke__\">first</span>();\n    <span class=\"hljs-variable language_\">$this</span>-&gt;category_id = <span class=\"hljs-variable\">$category</span>-&gt;id;\n}\n</code></pre>","children":[]}],"payload":{"lines":"1339,1340","fold":1}},{"content":"Update du slug du title","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">updatedTitle</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$value</span></span>) </span>{\n    <span class=\"hljs-variable language_\">$this</span>-&gt;slug      = <span class=\"hljs-title class_\">Str</span>::<span class=\"hljs-title function_ invoke__\">slug</span>(<span class=\"hljs-variable\">$value</span>);\n    <span class=\"hljs-variable language_\">$this</span>-&gt;seo_title = <span class=\"hljs-variable\">$value</span>;\n}\n</code></pre>","children":[]}],"payload":{"lines":"1377,1378","fold":1}},{"content":"Enregistrement","children":[{"content":"<pre><code class=\"language-php\">...\n\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">App</span>\\<span class=\"hljs-title\">Models</span>\\{<span class=\"hljs-title\">Category</span>, <span class=\"hljs-title\">Post</span>};\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Mary</span>\\<span class=\"hljs-title\">Traits</span>\\<span class=\"hljs-title\">Toast</span>;\n\n<span class=\"hljs-keyword\">new</span> <span class=\"hljs-meta\">#[Layout</span>(<span class=\"hljs-string\">'components.layouts.admin'</span>)<span class=\"hljs-meta\">]</span> \n<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Component</span> </span>{\n    <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Toast</span>;\n\n    ...\n\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">save</span>(<span class=\"hljs-params\"></span>) </span>{\n        <span class=\"hljs-variable\">$data</span> = <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">validate</span>();\n\n    <span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-title function_ invoke__\">create</span>(\n        <span class=\"hljs-variable\">$data</span> + [\n            <span class=\"hljs-string\">'user_id'</span>     =&gt; <span class=\"hljs-title class_\">Auth</span>::<span class=\"hljs-title function_ invoke__\">id</span>(),\n            <span class=\"hljs-string\">'category_id'</span> =&gt; <span class=\"hljs-variable\">$this</span>-&gt;category_id,\n        ],\n    );\n\n        <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">success</span>(<span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'Post added with success.'</span>), <span class=\"hljs-attr\">redirectTo</span>: <span class=\"hljs-string\">'/admin/posts/index'</span>);\n    }\n</code></pre>","children":[]}],"payload":{"lines":"1386,1387","fold":1}}],"payload":{"lines":"1265,1266"}},{"content":"Gestion de l'image","children":[{"content":"Ajout du trait Livewire WithFileUploads","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Livewire</span>\\<span class=\"hljs-title\">Features</span>\\<span class=\"hljs-title\">SupportFileUploads</span>\\<span class=\"hljs-title\">TemporaryUploadedFile</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Livewire</span>\\<span class=\"hljs-title\">WithFileUploads</span>;\n\n<span class=\"hljs-keyword\">new</span> <span class=\"hljs-meta\">#[Layout</span>(<span class=\"hljs-string\">'components.layouts.admin'</span>)<span class=\"hljs-meta\">]</span> \n<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Component</span> </span>{\n    <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">WithFileUploads</span>, <span class=\"hljs-title\">Toast</span>;\n\n    <span class=\"hljs-meta\">#[Rule</span>(<span class=\"hljs-string\">'required|image|max:2000'</span>)<span class=\"hljs-meta\">]</span>\n\t<span class=\"hljs-keyword\">public</span> ?TemporaryUploadedFile <span class=\"hljs-variable\">$photo</span> = <span class=\"hljs-literal\">null</span>;\n</code></pre>","children":[]}],"payload":{"lines":"1416,1417","fold":1}},{"content":"Composant dans form","children":[{"content":"<pre><code class=\"language-php\">            &lt;x-file wire:model=\"photo\" label=\"{{ __('Featured image') }}\"\n                hint=\"{{ __('Click on the image to modify') }}\" accept=\"image/png, image/jpeg\"&gt;\n                &lt;img src=\"{{ $photo == '' ? '/storage/ask.jpg' : $photo }}\" class=\"h-40\" /&gt;\n            &lt;/x-file&gt;\n            &lt;x-slot:actions&gt;\n                ...\n            &lt;/x-slot:actions&gt;\n        &lt;/x-form&gt;\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1430,1431","fold":1}},{"content":"Traductions","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Featured image\"</span>: <span class=\"hljs-string\">\"Image mise en avant\"</span>,\n<span class=\"hljs-string\">\"Click on the image to modify\"</span>: <span class=\"hljs-string\">\"Cliquez sur cette image pour la modifier\"</span>,\n</code></pre>","children":[]}],"payload":{"lines":"1445,1446","fold":1}},{"content":"Image / défaut","children":[{"content":"<a href=\"https://laravel.sillo.org/ask.jpg\">Récupérer l'image</a>","children":[],"payload":{"lines":"1454,1455"}},{"content":"À poser dans : ./public/storage/ask.jpg","children":[],"payload":{"lines":"1455,1457"}}],"payload":{"lines":"1452,1453","fold":1}},{"content":"Save","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">save</span>(<span class=\"hljs-params\"></span>)\n</span>{\n    <span class=\"hljs-variable\">$data</span> = <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">validate</span>();\n\n    <span class=\"hljs-variable\">$date</span> = <span class=\"hljs-title function_ invoke__\">now</span>()-&gt;<span class=\"hljs-title function_ invoke__\">format</span>(<span class=\"hljs-string\">'Y/m'</span>);\n    <span class=\"hljs-variable\">$path</span> = <span class=\"hljs-variable\">$date</span> . <span class=\"hljs-string\">'/'</span> . <span class=\"hljs-title function_ invoke__\">basename</span>(<span class=\"hljs-variable\">$this</span>-&gt;photo-&gt;<span class=\"hljs-title function_ invoke__\">store</span>(<span class=\"hljs-string\">'photos/'</span> . <span class=\"hljs-variable\">$date</span>, <span class=\"hljs-string\">'public'</span>));\n\n    <span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-title function_ invoke__\">create</span>(\n        <span class=\"hljs-variable\">$data</span> + [\n            <span class=\"hljs-string\">'user_id'</span>     =&gt; <span class=\"hljs-title class_\">Auth</span>::<span class=\"hljs-title function_ invoke__\">id</span>(),\n            <span class=\"hljs-string\">'category_id'</span> =&gt; <span class=\"hljs-variable\">$this</span>-&gt;category_id,\n            <span class=\"hljs-string\">'image'</span>       =&gt; <span class=\"hljs-variable\">$path</span>,\n        ],\n    );\n\n    <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">success</span>(<span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'Post added with success.'</span>), <span class=\"hljs-attr\">redirectTo</span>: <span class=\"hljs-string\">'/admin/posts/index'</span>);\n}\n</code></pre>","children":[]}],"payload":{"lines":"1457,1458","fold":1}},{"content":"Url des images","children":[{"content":"<pre data-lines=\"1483,1484\"><code>Ajout dans app/helpers.php :\n</code></pre>","children":[],"payload":{"lines":"1483,1484"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-title function_ invoke__\">function_exists</span>(<span class=\"hljs-string\">'replaceAbsoluteUrlsWithRelative'</span>)) {\n  <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">replaceAbsoluteUrlsWithRelative</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$content</span></span>) </span>{\n      <span class=\"hljs-variable\">$baseUrl</span> = <span class=\"hljs-title function_ invoke__\">url</span>(<span class=\"hljs-string\">'/'</span>);\n  \n      <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-string\">'/'</span> !== <span class=\"hljs-title function_ invoke__\">substr</span>(<span class=\"hljs-variable\">$baseUrl</span>, -<span class=\"hljs-number\">1</span>)) {\n          <span class=\"hljs-variable\">$baseUrl</span> .= <span class=\"hljs-string\">'/'</span>;\n      }\n      \n      <span class=\"hljs-variable\">$pattern</span>     = <span class=\"hljs-string\">'/&lt;img\\s+[^&gt;]*src=\"(?:https?:\\/\\/)?'</span> . <span class=\"hljs-title function_ invoke__\">preg_quote</span>(<span class=\"hljs-title function_ invoke__\">parse_url</span>(<span class=\"hljs-variable\">$baseUrl</span>, PHP_URL_HOST), <span class=\"hljs-string\">'/'</span>) . <span class=\"hljs-string\">'\\/([^\"]+)\"/i'</span>;\n      <span class=\"hljs-variable\">$replacement</span> = <span class=\"hljs-string\">'&lt;img src=\"/$1\"'</span>;\n  \n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_ invoke__\">preg_replace</span>(<span class=\"hljs-variable\">$pattern</span>, <span class=\"hljs-variable\">$replacement</span>, <span class=\"hljs-variable\">$content</span>);\n  }\n}\n</code></pre>","children":[]},{"content":"<pre data-lines=\"1502,1503\"><code>Adaptation de save() :\n</code></pre>","children":[],"payload":{"lines":"1502,1503"}},{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">save</span>(<span class=\"hljs-params\"></span>) </span>{\n   ...\n\n    <span class=\"hljs-variable\">$data</span>[<span class=\"hljs-string\">'body'</span>] = <span class=\"hljs-title function_ invoke__\">replaceAbsoluteUrlsWithRelative</span>(<span class=\"hljs-variable\">$data</span>[<span class=\"hljs-string\">'body'</span>]);\n    \n    <span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-title function_ invoke__\">create</span>(\n\n    ...\n\n}\n</code></pre>","children":[]}],"payload":{"lines":"1481,1482","fold":1}}],"payload":{"lines":"1414,1415","fold":1}}],"payload":{"lines":"1257,1258","fold":1}},{"content":"Routes","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-string\">'auth'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n\t...\n\t<span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-title class_\">IsAdminOrRedac</span>::<span class=\"hljs-variable language_\">class</span>)-&gt;<span class=\"hljs-title function_ invoke__\">prefix</span>(<span class=\"hljs-string\">'admin'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n\t\t...\n\t\t<span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/posts/create'</span>, <span class=\"hljs-string\">'admin.posts.create'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'posts.create'</span>);\n\t});\n});\n</code></pre>","children":[]}],"payload":{"lines":"1516,1517","fold":1}},{"content":"Menu (admin.sidebar)","children":[{"content":"<pre><code class=\"language-php\">&lt;x-menu-sub title=<span class=\"hljs-string\">\"{{ __('Posts') }}\"</span> icon=<span class=\"hljs-string\">\"s-document-text\"</span>&gt;\n    &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('All posts') }}\"</span> link=<span class=\"hljs-string\">\"{{ route('posts.index') }}\"</span> /&gt;\n    &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('Add a post') }}\"</span> link=<span class=\"hljs-string\">\"{{ route('posts.create') }}\"</span> /&gt;\n&lt;/x-menu-sub&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1528,1529","fold":1}},{"content":"Éditeur (TinyMCE)","children":[{"content":"Installation hébergée (Usage Illimité)","children":[{"content":"<a href=\"https://www.tiny.cloud/get-tiny\">Télécharger Free TinyMCE</a>","children":[],"payload":{"lines":"1541,1542"}},{"content":"Installer dans : ./storage/app/public/scripts","children":[],"payload":{"lines":"1543,1544"}},{"content":"Paramétrage","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-meta\">&lt;?php</span>\n<span class=\"hljs-comment\">// Fichier config/tinymce.php</span>\n\n<span class=\"hljs-keyword\">return</span> [\n<span class=\"hljs-string\">'config'</span> =&gt; [\n  <span class=\"hljs-string\">'language'</span>       =&gt; <span class=\"hljs-title function_ invoke__\">env</span>(<span class=\"hljs-string\">'APP_TINYMCE_LOCALE'</span>, <span class=\"hljs-string\">'en_US'</span>),\n  <span class=\"hljs-string\">'plugins'</span>        =&gt; <span class=\"hljs-string\">'codesample fullscreen'</span>,\n  <span class=\"hljs-string\">'toolbar'</span>        =&gt; <span class=\"hljs-string\">'undo redo style | fontfamily fontsize | alignleft aligncenter alignright alignjustify | bullist numlist | copy cut paste pastetext | hr | codesample | link image quicktable | fullscreen'</span>,\n  <span class=\"hljs-string\">'toolbar_sticky'</span> =&gt; <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-string\">'min_height'</span>     =&gt; <span class=\"hljs-number\">1000</span>,\n  <span class=\"hljs-string\">'license_key'</span>    =&gt; <span class=\"hljs-string\">'gpl'</span>,\n  <span class=\"hljs-string\">'valid_elements'</span> =&gt; <span class=\"hljs-string\">'*[*]'</span>,\n],\n];\n</code></pre>","children":[]},{"content":"<pre><code class=\"language-php\">\n<span class=\"hljs-comment\">// Fichier ./.env</span>\n\nAPP_TINYMCE_LOCALE=fr_FR\n</code></pre>","children":[]}],"payload":{"lines":"1545,1546"}},{"content":"Traductions","children":[{"content":"\n<p data-lines=\"1573,1574\"><a href=\"https://www.tiny.cloud/get-tiny/language-packages\">Récupérer les fichiers de traduction</a></p>","children":[],"payload":{"lines":"1573,1575"}},{"content":"\n<p data-lines=\"1575,1576\">Les copier dans : ./storage/app/public/scripts/fr_FR.js</p>","children":[],"payload":{"lines":"1575,1577"}}],"payload":{"lines":"1571,1572"}},{"content":"Activation","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-comment\">// Fichier ./resources\\views\\components\\layouts\\admin.blade.php</span>\n&lt;script src=<span class=\"hljs-string\">\"{{ asset('storage/scripts/tinymce.min.js') }}\"</span> &gt;&lt;/script&gt;\n... @<span class=\"hljs-title function_ invoke__\">vite</span>(...)\n</code></pre>","children":[]}],"payload":{"lines":"1577,1578"}}],"payload":{"lines":"1539,1540","fold":1}},{"content":"Installation CDN (Usage limité: 1000 appels/mois - Mise à jour auto)","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-comment\">// Fichier ./resources\\views\\components\\layouts\\admin.blade.php</span>\n&lt;script src=<span class=\"hljs-string\">\"https://cdn.tiny.cloud/1/YOUR-KEY-HERE/tinymce/6/tinymce.min.js\"</span> referrerpolicy=<span class=\"hljs-string\">\"origin\"</span>&gt;&lt;/script&gt;\n... @<span class=\"hljs-title function_ invoke__\">vite</span>(...)\n</code></pre>","children":[]}],"payload":{"lines":"1586,1587","fold":1}}],"payload":{"lines":"1537,1538","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://mary-ui.com/docs/components/editor\">https://mary-ui.com/docs/components/editor</a></strong></em>","children":[],"payload":{"lines":"1594,1595"}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-creer-un-article#top\">https://laravel.sillo.org/posts/mon-cms-creer-un-article#top</a></strong></em>","children":[],"payload":{"lines":"1596,1597"}}],"payload":{"lines":"1255,1256","fold":1}},{"content":"Modifier un article","children":[{"content":"Composant","children":[{"content":"Création","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/posts/edit --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"1602,1603","fold":1}},{"content":"Route posts.edit","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-comment\">// Dans le groupe du middleware 'IsAdminOrRedac'</span>\n<span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/posts/{post:slug}/edit'</span>, <span class=\"hljs-string\">'admin.posts.edit'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'posts.edit'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"1608,1609","fold":1}},{"content":"Lien dans tableau des articles (posts.index)","children":[{"content":"<pre><code class=\"language-php\">&lt;x-table striped :headers=<span class=\"hljs-string\">\"<span class=\"hljs-subst\">$headers</span>\"</span> :rows=<span class=\"hljs-string\">\"<span class=\"hljs-subst\">$posts</span>\"</span> :sort-by=<span class=\"hljs-string\">\"<span class=\"hljs-subst\">$sortBy</span>\"</span> link=<span class=\"hljs-string\">\"/admin/posts/{slug}/edit\"</span> with-pagination&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1615,1616","fold":1}},{"content":"Formulaire","children":[{"content":"<pre><code class=\"language-php\">&lt;div&gt;\n    &lt;x-header title=\"{{ __('Edit a post') }}\" separator progress-indicator&gt;\n        &lt;x-slot:actions&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline lg:hidden\"\n                link=\"{{ route('admin') }}\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n\n    &lt;x-card&gt;\n        &lt;x-form wire:submit=\"save\"&gt;\n           \t&lt;x-select label=\"{{ __('Category') }}\" option-label=\"title\" :options=\"$categories\" wire:model=\"category_id\"\n                wire:change=\"$refresh\" /&gt;\n\t\t\t&lt;br&gt;\n            &lt;div class=\"flex gap-6\"&gt;\n                &lt;x-checkbox label=\"{{ __('Published') }}\" wire:model=\"active\" /&gt;\n                &lt;x-checkbox label=\"{{ __('Pinned') }}\" wire:model=\"pinned\" /&gt;\n            &lt;/div&gt;\n            &lt;x-input type=\"text\" wire:model=\"title\" label=\"{{ __('Title') }}\"\n                placeholder=\"{{ __('Enter the title') }}\" wire:change=\"$refresh\" /&gt;\n            &lt;x-input type=\"text\" wire:model=\"slug\" label=\"{{ __('Slug') }}\" /&gt;\n            &lt;x-editor wire:model=\"body\" label=\"{{ __('Content') }}\" :config=\"config('tinymce.config')\"\n                folder=\"{{ 'photos/' . now()-&gt;format('Y/m') }}\" /&gt;\n            &lt;x-card title=\"{{ __('SEO') }}\" shadow separator&gt;\n                &lt;x-input placeholder=\"{{ __('Title') }}\" wire:model=\"seo_title\" hint=\"{{ __('Max 70 chars') }}\" /&gt;\n                &lt;br&gt;\n                &lt;x-textarea label=\"{{ __('META Description') }}\" wire:model=\"meta_description\"\n                    hint=\"{{ __('Max 160 chars') }}\" rows=\"2\" inline /&gt;\n                &lt;br&gt;\n                &lt;x-textarea label=\"{{ __('META Keywords') }}\" wire:model=\"meta_keywords\"\n                    hint=\"{{ __('Keywords separated by comma') }}\" rows=\"1\" inline /&gt;\n            &lt;/x-card&gt;\n            &lt;x-file wire:model=\"photo\" label=\"{{ __('Featured image') }}\"\n                hint=\"{{ __('Click on the image to modify') }}\" accept=\"image/png, image/jpeg\"&gt;\n                &lt;img src=\"{{ asset('storage/photos/' . $post-&gt;image) }}\" class=\"h-40\" /&gt;\n            &lt;/x-file&gt;\n            &lt;x-slot:actions&gt;\n                &lt;x-button label=\"{{ __('Preview') }}\" icon=\"m-sun\" link=\"{{ '/posts/' . $post-&gt;slug }}\" external\n                    class=\"btn-outline\" /&gt;\n                &lt;x-button label=\"{{ __('Save') }}\" icon=\"o-paper-airplane\" spinner=\"save\" type=\"submit\"\n                    class=\"btn-primary\" /&gt;\n            &lt;/x-slot:actions&gt;\n        &lt;/x-form&gt;\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1621,1622","fold":1}},{"content":"La logique","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-meta\">&lt;?php</span>\n\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">App</span>\\<span class=\"hljs-title\">Models</span>\\{<span class=\"hljs-title\">Category</span>, <span class=\"hljs-title\">Post</span>};\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Support</span>\\<span class=\"hljs-title\">Collection</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Support</span>\\<span class=\"hljs-title\">Facades</span>\\<span class=\"hljs-title\">Storage</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">illuminate</span>\\<span class=\"hljs-title\">Support</span>\\<span class=\"hljs-title\">Str</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Validation</span>\\<span class=\"hljs-title\">Rule</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Livewire</span>\\<span class=\"hljs-title\">Attributes</span>\\{<span class=\"hljs-title\">Layout</span>, <span class=\"hljs-title\">Title</span>};\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Livewire</span>\\<span class=\"hljs-title\">Features</span>\\<span class=\"hljs-title\">SupportFileUploads</span>\\<span class=\"hljs-title\">TemporaryUploadedFile</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Livewire</span>\\<span class=\"hljs-title\">Volt</span>\\<span class=\"hljs-title\">Component</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Livewire</span>\\<span class=\"hljs-title\">WithFileUploads</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Mary</span>\\<span class=\"hljs-title\">Traits</span>\\<span class=\"hljs-title\">Toast</span>;\n\n<span class=\"hljs-keyword\">new</span> <span class=\"hljs-meta\">#[Title</span>(<span class=\"hljs-string\">'Edit Post'</span>), <span class=\"hljs-meta\">Layout</span>(<span class=\"hljs-string\">'components.layouts.admin'</span>)<span class=\"hljs-meta\">]</span> \n<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Component</span> </span>{\n  <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">WithFileUploads</span>, <span class=\"hljs-title\">Toast</span>;\n  \n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">int</span> <span class=\"hljs-variable\">$postId</span>;\n  <span class=\"hljs-keyword\">public</span> ?Collection <span class=\"hljs-variable\">$categories</span>;\n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">int</span> <span class=\"hljs-variable\">$category_id</span>;\n  <span class=\"hljs-keyword\">public</span> Post <span class=\"hljs-variable\">$post</span>;\n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$body</span>                  = <span class=\"hljs-string\">''</span>;\n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$title</span>                 = <span class=\"hljs-string\">''</span>;\n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$slug</span>                  = <span class=\"hljs-string\">''</span>;\n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">bool</span> <span class=\"hljs-variable\">$active</span>                  = <span class=\"hljs-literal\">false</span>;\n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">bool</span> <span class=\"hljs-variable\">$pinned</span>                  = <span class=\"hljs-literal\">false</span>;\n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$seo_title</span>             = <span class=\"hljs-string\">''</span>;\n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$meta_description</span>      = <span class=\"hljs-string\">''</span>;\n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$meta_keywords</span>         = <span class=\"hljs-string\">''</span>;\n  <span class=\"hljs-keyword\">public</span> ?TemporaryUploadedFile <span class=\"hljs-variable\">$photo</span> = <span class=\"hljs-literal\">null</span>;\n  \n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">mount</span>(<span class=\"hljs-params\">Post <span class=\"hljs-variable\">$post</span></span>): <span class=\"hljs-title\">void</span>\n  </span>{\n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title function_ invoke__\">Auth</span>()-&gt;<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isRedac</span>() &amp;&amp; <span class=\"hljs-variable\">$post</span>-&gt;user_id !== <span class=\"hljs-title function_ invoke__\">Auth</span>()-&gt;<span class=\"hljs-title function_ invoke__\">id</span>()) {\n      <span class=\"hljs-title function_ invoke__\">abort</span>(<span class=\"hljs-number\">403</span>);\n    }\n  \n    <span class=\"hljs-variable language_\">$this</span>-&gt;post = <span class=\"hljs-variable\">$post</span>;\n    <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">fill</span>(<span class=\"hljs-variable\">$this</span>-&gt;post);\n    <span class=\"hljs-variable language_\">$this</span>-&gt;categories = <span class=\"hljs-title class_\">Category</span>::<span class=\"hljs-title function_ invoke__\">orderBy</span>(<span class=\"hljs-string\">'title'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">get</span>();\n  }\n  \n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">updatedTitle</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$value</span></span>)\n  </span>{\n    <span class=\"hljs-variable language_\">$this</span>-&gt;slug      = <span class=\"hljs-title class_\">Str</span>::<span class=\"hljs-title function_ invoke__\">slug</span>(<span class=\"hljs-variable\">$value</span>);\n    <span class=\"hljs-variable language_\">$this</span>-&gt;seo_title = <span class=\"hljs-variable\">$value</span>;\n  }\n  \n  <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">save</span>(<span class=\"hljs-params\"></span>)\n  </span>{\n    <span class=\"hljs-variable\">$data</span> = <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">validate</span>([\n      <span class=\"hljs-string\">'title'</span>            =&gt; <span class=\"hljs-string\">'required|string|max:255'</span>,\n      <span class=\"hljs-string\">'body'</span>             =&gt; <span class=\"hljs-string\">'required|string|max:16777215'</span>,\n      <span class=\"hljs-string\">'category_id'</span>      =&gt; <span class=\"hljs-string\">'required'</span>,\n      <span class=\"hljs-string\">'photo'</span>            =&gt; <span class=\"hljs-string\">'nullable|image|max:2000'</span>,\n      <span class=\"hljs-string\">'active'</span>           =&gt; <span class=\"hljs-string\">'required'</span>,\n      <span class=\"hljs-string\">'pinned'</span>           =&gt; <span class=\"hljs-string\">'required'</span>,\n      <span class=\"hljs-string\">'slug'</span>             =&gt; [<span class=\"hljs-string\">'required'</span>, <span class=\"hljs-string\">'string'</span>, <span class=\"hljs-string\">'max:255'</span>, <span class=\"hljs-string\">'regex:/^[a-z0-9]+(?:-[a-z0-9]+)*$/'</span>, <span class=\"hljs-title class_\">Rule</span>::<span class=\"hljs-title function_ invoke__\">unique</span>(<span class=\"hljs-string\">'posts'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">ignore</span>(<span class=\"hljs-variable\">$this</span>-&gt;post-&gt;id)],\n      <span class=\"hljs-string\">'seo_title'</span>        =&gt; <span class=\"hljs-string\">'required|max:70'</span>,\n      <span class=\"hljs-string\">'meta_description'</span> =&gt; <span class=\"hljs-string\">'required|max:160'</span>,\n      <span class=\"hljs-string\">'meta_keywords'</span>    =&gt; <span class=\"hljs-string\">'required|regex:/^[A-Za-z0-9-éèàù]{1,50}?(,[A-Za-z0-9-éèàù]{1,50})*$/'</span>,\n    ]);\n    \n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable language_\">$this</span>-&gt;photo) {\n      <span class=\"hljs-variable\">$date</span>          = <span class=\"hljs-title function_ invoke__\">now</span>()-&gt;<span class=\"hljs-title function_ invoke__\">format</span>(<span class=\"hljs-string\">'Y/m'</span>);\n      <span class=\"hljs-variable\">$path</span>          = <span class=\"hljs-variable\">$date</span> . <span class=\"hljs-string\">'/'</span> . <span class=\"hljs-title function_ invoke__\">basename</span>(<span class=\"hljs-variable\">$this</span>-&gt;photo-&gt;<span class=\"hljs-title function_ invoke__\">store</span>(<span class=\"hljs-string\">'photos/'</span> . <span class=\"hljs-variable\">$date</span>, <span class=\"hljs-string\">'public'</span>));\n      <span class=\"hljs-variable\">$data</span>[<span class=\"hljs-string\">'image'</span>] = <span class=\"hljs-variable\">$path</span>;\n    }\n    \n    <span class=\"hljs-variable\">$data</span>[<span class=\"hljs-string\">'body'</span>] = <span class=\"hljs-title function_ invoke__\">replaceAbsoluteUrlsWithRelative</span>(<span class=\"hljs-variable\">$data</span>[<span class=\"hljs-string\">'body'</span>]);\n    \n    <span class=\"hljs-variable language_\">$this</span>-&gt;post-&gt;<span class=\"hljs-title function_ invoke__\">update</span>(\n      <span class=\"hljs-variable\">$data</span> + [\n      <span class=\"hljs-string\">'category_id'</span> =&gt; <span class=\"hljs-variable\">$this</span>-&gt;category_id,\n      ],\n    );\n    \n    <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">success</span>(<span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'Post updated with success.'</span>));\n  }\n}; <span class=\"hljs-meta\">?&gt;</span>\n</code></pre>","children":[]}],"payload":{"lines":"1670,1671","fold":1}},{"content":"Traduction Éditer","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Edit a post\"</span>: <span class=\"hljs-string\">\"Modifier un article\"</span>,\n<span class=\"hljs-string\">\"Post updated with success.\"</span>: <span class=\"hljs-string\">\"Article mis à jour avec succès.\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"1755,1756","fold":1}},{"content":"Bouton édition dans le posts.show","children":[{"content":"HTML","children":[{"content":"<pre><code class=\"language-php\">@auth\n    &lt;x-popover&gt;\n        ...\n    &lt;/x-popover&gt;\n    @if (Auth::user()-&gt;isAdmin() || Auth::user()-&gt;id == $post-&gt;user_id)\n        &lt;x-popover&gt;\n            &lt;x-slot:trigger&gt;\n                &lt;x-button icon=\"c-pencil-square\" link=\"{{ route('posts.edit', $post) }}\" spinner\n                    class=\"btn-ghost btn-sm\" /&gt;\n            &lt;/x-slot:trigger&gt;\n            &lt;x-slot:content class=\"pop-small\"&gt;\n                @lang('Edit this post')\n            &lt;/x-slot:content&gt;\n        &lt;/x-popover&gt;\n    @endif\n@endauth\n</code></pre>","children":[]}],"payload":{"lines":"1764,1765"}},{"content":"Traduction Modifier","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Edit this post\"</span>: <span class=\"hljs-string\">\"Modifier cet article\"</span>,\n</code></pre>","children":[]}],"payload":{"lines":"1785,1786"}}],"payload":{"lines":"1762,1763","fold":1}},{"content":"Bouton clone dans le posts.show","children":[{"content":"HTML","children":[{"content":"<pre><code class=\"language-php\">@if (Auth::user()-&gt;isAdmin() || Auth::user()-&gt;id == $post-&gt;user_id)\n    &lt;x-popover&gt;\n        ...\n    &lt;/x-popover&gt;\n    &lt;x-popover&gt;\n        &lt;x-slot:trigger&gt;\n            &lt;x-button icon=\"o-finger-print\" wire:click=\"clonePost({{ $post-&gt;id }})\" spinner\n                class=\"btn-ghost btn-sm\" /&gt;\n        &lt;/x-slot:trigger&gt;\n        &lt;x-slot:content class=\"pop-small\"&gt;\n            @lang('Clone this post')\n        &lt;/x-slot:content&gt;\n    &lt;/x-popover&gt;\n@endif\n</code></pre>","children":[]}],"payload":{"lines":"1793,1794","fold":1}},{"content":"Traduction Clone","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Clone this post\"</span>: <span class=\"hljs-string\">\"Dupliquer cet article\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"1812,1813","fold":1}},{"content":"Logique du clonage","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">clonePost</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-variable\">$postId</span></span>): <span class=\"hljs-title\">void</span>\n</span>{\n    <span class=\"hljs-variable\">$originalPost</span> = <span class=\"hljs-title class_\">Post</span>::<span class=\"hljs-title function_ invoke__\">findOrFail</span>(<span class=\"hljs-variable\">$postId</span>);\n    <span class=\"hljs-variable\">$clonedPost</span> = <span class=\"hljs-variable\">$originalPost</span>-&gt;<span class=\"hljs-title function_ invoke__\">replicate</span>();\n    <span class=\"hljs-variable\">$postRepository</span> = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">PostRepository</span>();\n    <span class=\"hljs-variable\">$clonedPost</span>-&gt;slug = <span class=\"hljs-variable\">$postRepository</span>-&gt;<span class=\"hljs-title function_ invoke__\">generateUniqueSlug</span>(<span class=\"hljs-variable\">$originalPost</span>-&gt;slug);\n    <span class=\"hljs-variable\">$clonedPost</span>-&gt;active = <span class=\"hljs-literal\">false</span>;\n    <span class=\"hljs-variable\">$clonedPost</span>-&gt;<span class=\"hljs-title function_ invoke__\">save</span>();\n\n    <span class=\"hljs-title function_ invoke__\">redirect</span>()-&gt;<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'posts.edit'</span>, <span class=\"hljs-variable\">$clonedPost</span>-&gt;slug);\n}\n</code></pre>","children":[]}],"payload":{"lines":"1818,1819","fold":1}},{"content":"Lien Articles dans dashboard","children":[{"content":"<pre><code class=\"language-php\">// admin.index\n&lt;a href=\"{{ route('posts.index') }}\" class=\"flex-grow\"&gt;\n    &lt;x-stat title=\"{{ __('Posts') }}\" description=\"\" value=\"{{ $posts-&gt;count() }}\" icon=\"s-document-text\"\n        class=\"shadow-hover\" /&gt;\n&lt;/a&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1834,1835","fold":1}}],"payload":{"lines":"1791,1792","fold":1}}],"payload":{"lines":"1600,1601"}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-modifier-un-article\">https://laravel.sillo.org/posts/mon-cms-modifier-un-article</a></strong></em>","children":[],"payload":{"lines":"1844,1845"}}],"payload":{"lines":"1598,1599","fold":1}}],"payload":{"lines":"1016,1017","fold":1}},{"content":"Les catégories","children":[{"content":"Création category.index","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/categories/index --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"1848,1849","fold":1}},{"content":"Route categories.index","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">App</span>\\<span class=\"hljs-title\">Http</span>\\<span class=\"hljs-title\">Middleware</span>\\{<span class=\"hljs-title\">IsAdmin</span>, <span class=\"hljs-title\">IsAdminOrRedac</span>};\n...\n<span class=\"hljs-comment\">// Dans le groupe du middleware 'IsAdminOrRedac'</span>\n<span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-title class_\">IsAdmin</span>::<span class=\"hljs-variable language_\">class</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n    <span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/categories/index'</span>, <span class=\"hljs-string\">'admin.categories.index'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'categories.index'</span>);\n});\n</code></pre>","children":[]}],"payload":{"lines":"1854,1855","fold":1}},{"content":"Item dans barre latérale","children":[{"content":"HTML Item dans admin.sidebar","children":[{"content":"<pre><code class=\"language-php\">&lt;x-menu-sub title=<span class=\"hljs-string\">\"{{ __('Posts') }}\"</span> icon=<span class=\"hljs-string\">\"s-document-text\"</span>&gt;\n    ...\n    @<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title class_\">Auth</span>::<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isAdmin</span>())\n        &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('Categories') }}\"</span> link=<span class=\"hljs-string\">\"{{ route('categories.index') }}\"</span> /&gt;\n    @<span class=\"hljs-keyword\">endif</span>\n&lt;/x-menu-sub&gt; \n</code></pre>","children":[]}],"payload":{"lines":"1867,1868"}},{"content":"Traduction Item &lt;!-- markmap: fold --&gt;","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Categories\"</span>: <span class=\"hljs-string\">\"Catégories\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"1877,1878"}}],"payload":{"lines":"1865,1866","fold":1}},{"content":"Code composant categories.index","children":[{"content":"Base","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\n\nuse Livewire\\Volt\\Component;\nuse App\\Models\\Category;\nuse Livewire\\WithPagination;\nuse Livewire\\Attributes\\Layout;\n\nnew #[Layout('components.layouts.admin')] \nclass extends Component {\n    use WithPagination;\n\n    public array $sortBy = ['column' =&gt; 'title', 'direction' =&gt; 'asc'];\n\n    public function headers(): array\n    {\n        return [['key' =&gt; 'title', 'label' =&gt; __('Title')], ['key' =&gt; 'slug', 'label' =&gt; 'Slug']];\n    }\n    \n    public function with(): array\n    {\n        return [\n            'categories' =&gt; Category::orderBy(...array_values($this-&gt;sortBy))-&gt;paginate(10),\n            'headers'    =&gt; $this-&gt;headers(),\n        ];\n    }\n    \n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header title=\"{{ __('Categories') }}\" separator progress-indicator&gt;\n        &lt;x-slot:actions class=\"lg:hidden\"&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline\"\n                link=\"{{ route('admin') }}\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n    &lt;x-card&gt;\n        &lt;x-table striped :headers=\"$headers\" :rows=\"$categories\" :sort-by=\"$sortBy\" link=\"#\"\n            with-pagination&gt;\n        &lt;/x-table&gt;\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1885,1886","fold":1}},{"content":"Ajout bouton supprimer catégorie","children":[{"content":"HTML Supprimer catégorie","children":[{"content":"<pre><code class=\"language-php\">&lt;x-table striped :headers=\"$headers\" :rows=\"$categories\" :sort-by=\"$sortBy\" link=\"#\"\n    with-pagination&gt;\n        @scope('actions', $category)\n        &lt;x-popover&gt;\n            &lt;x-slot:trigger&gt;\n                &lt;x-button icon=\"o-trash\" wire:click=\"delete({{ $category-&gt;id }})\"\n                    wire:confirm=\"{{ __('Are you sure to delete this category?') }}\" spinner\n                    class=\"text-red-500 btn-ghost btn-sm\" /&gt;\n            &lt;/x-slot:trigger&gt;\n            &lt;x-slot:content class=\"pop-small\"&gt;\n                @lang('Delete')\n            &lt;/x-slot:content&gt;\n        &lt;/x-popover&gt;\n    @endscope\n&lt;/x-table&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1933,1934"}},{"content":"Logique Supprimer catégorie","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">delete</span>(<span class=\"hljs-params\">Category <span class=\"hljs-variable\">$category</span></span>): <span class=\"hljs-title\">void</span>\n</span>{\n    <span class=\"hljs-variable\">$category</span>-&gt;<span class=\"hljs-title function_ invoke__\">delete</span>();\n    <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">success</span>(<span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'Category deleted with success.'</span>));\n}\n</code></pre>","children":[]}],"payload":{"lines":"1953,1954"}},{"content":"Traduction Supprimer catégorie","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Are you sure to delete this category?\"</span>: <span class=\"hljs-string\">\"Êtes-vous sûr de vouloir supprimer cette catégorie ?\"</span>,\n<span class=\"hljs-string\">\"Category deleted with success.\"</span>: <span class=\"hljs-string\">\"Catégorie supprimée avec succès.\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"1963,1964"}}],"payload":{"lines":"1931,1932","fold":1}},{"content":"Formulaire catégorie","children":[{"content":"Composant formulaire creation/modification","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/categories/category-form\n</code></pre>","children":[]}],"payload":{"lines":"1972,1973","fold":1}},{"content":"HTML admin/categories/category-form.blade.php","children":[{"content":"<pre><code class=\"language-php\">&lt;x-form wire:submit=\"save\"&gt;\n    &lt;x-input label=\"{{ __('Title') }}\" wire:model.debounce.500ms=\"title\" wire:change=\"$refresh\" /&gt;\n    &lt;x-input type=\"text\" wire:model=\"slug\" label=\"{{ __('Slug') }}\" /&gt;\n    &lt;x-slot:actions&gt;\n        &lt;x-button label=\"{{ __('Save') }}\" icon=\"o-paper-airplane\" spinner=\"save\" type=\"submit\"\n            class=\"btn-primary\" /&gt;\n    &lt;/x-slot:actions&gt;\n&lt;/x-form&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1979,1980","fold":1}},{"content":"Ajout du formulaire Créer catégorie","children":[{"content":"<pre><code class=\"language-php\">    &lt;x-card title=<span class=\"hljs-string\">\"{{ __('Create a new category') }}\"</span>&gt;\n        @<span class=\"hljs-keyword\">include</span>(<span class=\"hljs-string\">'livewire.admin.categories.category-form'</span>)\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"1992,1993","fold":1}},{"content":"Complément logique validation catégorie","children":[{"content":"<pre><code class=\"language-php\">...\n\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Livewire</span>\\<span class=\"hljs-title\">Attributes</span>\\{<span class=\"hljs-title\">Layout</span>, <span class=\"hljs-title\">Validate</span>};\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Illuminate</span>\\<span class=\"hljs-title\">Support</span>\\<span class=\"hljs-title\">Str</span>;\n<span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Mary</span>\\<span class=\"hljs-title\">Traits</span>\\<span class=\"hljs-title\">Toast</span>;\n\n<span class=\"hljs-keyword\">new</span> <span class=\"hljs-meta\">#[Layout</span>(<span class=\"hljs-string\">'components.layouts.admin'</span>)<span class=\"hljs-meta\">]</span> \n<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">Component</span> </span>{\n    <span class=\"hljs-keyword\">use</span> <span class=\"hljs-title\">Toast</span>, <span class=\"hljs-title\">WithPagination</span>;\n\n    ...\n\n    <span class=\"hljs-meta\">#[Validate</span>(<span class=\"hljs-string\">'required|max:255|unique:categories,title'</span>)<span class=\"hljs-meta\">]</span>\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$title</span> = <span class=\"hljs-string\">''</span>;\n\n    <span class=\"hljs-meta\">#[Validate</span>(<span class=\"hljs-string\">'required|max:255|unique:posts,slug|regex:/^[a-z0-9]+(?:-[a-z0-9]+)*$/'</span>)<span class=\"hljs-meta\">]</span>\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$slug</span> = <span class=\"hljs-string\">''</span>;\n\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">updatedTitle</span>(<span class=\"hljs-params\"><span class=\"hljs-variable\">$value</span></span>): <span class=\"hljs-title\">void</span>\n\t</span>{\n\t\t<span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">generateSlug</span>(<span class=\"hljs-variable\">$value</span>);\n\t}\n\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">generateSlug</span>(<span class=\"hljs-params\"><span class=\"hljs-keyword\">string</span> <span class=\"hljs-variable\">$title</span></span>): <span class=\"hljs-title\">void</span>\n\t</span>{\n\t\t<span class=\"hljs-variable language_\">$this</span>-&gt;slug = <span class=\"hljs-title class_\">Str</span>::<span class=\"hljs-title function_ invoke__\">of</span>(<span class=\"hljs-variable\">$title</span>)-&gt;<span class=\"hljs-title function_ invoke__\">slug</span>(<span class=\"hljs-string\">'-'</span>);\n\t}\n\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">save</span>(<span class=\"hljs-params\"></span>): <span class=\"hljs-title\">void</span>\n\t</span>{\n\t\t<span class=\"hljs-variable\">$data</span> = <span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">validate</span>();\n\t\t<span class=\"hljs-title class_\">Category</span>::<span class=\"hljs-title function_ invoke__\">create</span>(<span class=\"hljs-variable\">$data</span>);\n\t\t<span class=\"hljs-variable language_\">$this</span>-&gt;<span class=\"hljs-title function_ invoke__\">success</span>(<span class=\"hljs-title function_ invoke__\">__</span>(<span class=\"hljs-string\">'Category created with success.'</span>));\n\t}\n</code></pre>","children":[]}],"payload":{"lines":"2001,2002","fold":1}},{"content":"Traduction Créer catégorie","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Create a new category\"</span>: <span class=\"hljs-string\">\"Créer une nouvelle catégorie\"</span>,\n<span class=\"hljs-string\">\"Category created with success.\"</span>: <span class=\"hljs-string\">\"Catégorie créée avec succès.\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"2040,2041","fold":1}}],"payload":{"lines":"1970,1971","fold":1}}],"payload":{"lines":"1883,1884","fold":1}},{"content":"Modification d'une catégorie","children":[{"content":"Création du composant modification","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/categories/edit --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"2049,2050","fold":1}},{"content":"Code du composant d'édition","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\nuse App\\Models\\Category;\nuse Illuminate\\Support\\Str;\nuse Illuminate\\Validation\\Rule;\nuse Livewire\\Attributes\\Layout;\nuse Livewire\\Volt\\Component;\nuse Mary\\Traits\\Toast;\n\nnew #[Layout('components.layouts.admin')] \nclass extends Component {\n  use Toast;\n  \n  public Category $category;\n  public string $title = '';\n  public string $slug  = '';\n  \n  public function mount(Category $category): void {\n    $this-&gt;category = $category;\n    $this-&gt;fill($this-&gt;category-&gt;toArray());\n  }\n  \n  public function updatedTitle($value): void {\n    $this-&gt;generateSlug($value);\n  }\n  \n  public function save(): void {\n    $data = $this-&gt;validate($this-&gt;rules());\n    $this-&gt;category-&gt;update($data);\n    $this-&gt;success(__('Category updated successfully.'), redirectTo: '/admin/categories/index');\n  }\n  \n  protected function rules(): array\n  {\n  return [\n      'title' =&gt; 'required|string|max:255',\n      'slug'  =&gt; ['required', 'string', 'max:255', 'regex:/^[a-z0-9]+(?:-[a-z0-9]+)*$/', Rule::unique('categories')-&gt;ignore($this-&gt;category-&gt;id)],\n  ];\n  }\n  \n  private function generateSlug(string $title): void\n  {\n    $this-&gt;slug = Str::of($title)-&gt;slug('-');\n  }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header title=\"{{ __('Edit a category') }}\" separator progress-indicator&gt;\n        &lt;x-slot:actions class=\"lg:hidden\"&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline\"\n                link=\"{{ route('admin') }}\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n    &lt;x-card&gt;\n        @include('livewire.admin.categories.category-form')\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"2055,2056","fold":1}},{"content":"Traduction modification de catégorie","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Category updated successfully.\"</span>: <span class=\"hljs-string\">\"Catégorie mise à jour avec succès.\"</span>,\n<span class=\"hljs-string\">\"Edit a category\"</span>: <span class=\"hljs-string\">\"Modifier une catégorie\"</span>,\n</code></pre>","children":[]}],"payload":{"lines":"2116,2117","fold":1}},{"content":"Lien dans tableau des catégories","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-comment\">// admin/categories/index</span>\n&lt;x-table striped :headers=<span class=\"hljs-string\">\"<span class=\"hljs-subst\">$headers</span>\"</span> :rows=<span class=\"hljs-string\">\"<span class=\"hljs-subst\">$categories</span>\"</span> :sort-by=<span class=\"hljs-string\">\"<span class=\"hljs-subst\">$sortBy</span>\"</span> link=<span class=\"hljs-string\">\"/admin/categories/{id}/edit\"</span> with-pagination&gt;\n</code></pre>","children":[]}],"payload":{"lines":"2123,2124","fold":1}},{"content":"Route pour la modification de catégorie","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-title class_\">Route</span>::<span class=\"hljs-title function_ invoke__\">middleware</span>(<span class=\"hljs-title class_\">IsAdmin</span>::<span class=\"hljs-variable language_\">class</span>)-&gt;<span class=\"hljs-title function_ invoke__\">group</span>(function () {\n\t...\n\t<span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/categories/{category}/edit'</span>, <span class=\"hljs-string\">'admin.categories.edit'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'categories.edit'</span>);\n});\n</code></pre>","children":[]}],"payload":{"lines":"2130,2131","fold":1}}],"payload":{"lines":"2047,2048","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-categories\">https://laravel.sillo.org/posts/mon-cms-les-categories</a></strong></em>","children":[],"payload":{"lines":"2139,2140"}}],"payload":{"lines":"1846,1847","fold":1}},{"content":"Les pages","children":[{"content":"Composant Pages","children":[{"content":"CLI Pages","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/pages/index --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"2145,2146"}},{"content":"Route Pages","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-comment\">// Groupe middleware IsAdminOrRedac &gt; IsAdmin</span>\n<span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/pages/index'</span>, <span class=\"hljs-string\">'admin.pages.index'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'pages.index'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"2151,2152"}},{"content":"Lien Pages","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-comment\">// admin.sidebar</span>\n@<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title class_\">Auth</span>::<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isAdmin</span>())\n    &lt;x-menu-sub title=<span class=\"hljs-string\">\"{{ __('Pages') }}\"</span> icon=<span class=\"hljs-string\">\"s-document\"</span>&gt;\n        &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('All pages') }}\"</span> link=<span class=\"hljs-string\">\"{{ route('pages.index') }}\"</span> /&gt;\n    &lt;/x-menu-sub&gt;\n@<span class=\"hljs-keyword\">endif</span>\n</code></pre>","children":[]}],"payload":{"lines":"2158,2159"}},{"content":"Traduction Pages","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"All pages\"</span>: <span class=\"hljs-string\">\"Toutes les pages\"</span>,\n</code></pre>","children":[]}],"payload":{"lines":"2169,2170"}},{"content":"Code Pages","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\n\nuse App\\Models\\Page;\nuse Livewire\\Attributes\\{Layout, Title};\nuse Livewire\\Volt\\Component;\nuse Livewire\\WithPagination;\nuse Mary\\Traits\\Toast;\n\nnew #[Title('Pages'), Layout('components.layouts.admin')] \nclass extends Component {\n  use Toast, WithPagination;\n  \n  public function headers(): array {\n    return [\n      ['key' =&gt; 'title',  'label' =&gt; __('Title')],\n      ['key' =&gt; 'slug',   'label' =&gt; 'Slug'],\n      ['key' =&gt; 'active', 'label' =&gt; __('Published')]\n    ];\n  }\n  \n  public function deletePage(Page $page): void {\n    $page-&gt;delete();\n    $this-&gt;success(__('Page deleted'));\n  }\n  \n  public function with(): array {\n    return [\n      'pages'   =&gt; Page::select('id', 'title', 'slug', 'active')-&gt;get(),\n      'headers' =&gt; $this-&gt;headers(),\n    ];\n  }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header title=\"{{ __('Pages') }}\" separator progress-indicator &gt;\n        &lt;x-slot:actions class=\"lg:hidden\"&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline\"\n                link=\"{{ route('admin') }}\" /&gt;\n            &lt;x-button icon=\"c-document-plus\" label=\"{{ __('Add a page') }}\" class=\"btn-outline\"\n                link=\"#\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n\n    &lt;x-card&gt;\n        &lt;x-table striped :headers=\"$headers\" :rows=\"$pages\" link=\"#\"&gt;\n            @scope('cell_active', $page)\n                @if ($page-&gt;active)\n                    &lt;x-icon name=\"o-check-circle\" /&gt;\n                @endif\n            @endscope\n            @scope('actions', $page)\n                &lt;x-popover&gt;\n                    &lt;x-slot:trigger&gt;\n                        &lt;x-button icon=\"o-trash\" wire:click=\"deletePage({{ $page-&gt;id }})\"\n                            wire:confirm=\"{{ __('Are you sure to delete this page?') }}\" spinner\n                            class=\"text-red-500 btn-ghost btn-sm\" /&gt;\n                    &lt;/x-slot:trigger&gt;\n                    &lt;x-slot:content class=\"pop-small\"&gt;\n                        @lang('Delete')\n                    &lt;/x-slot:content&gt;\n                &lt;/x-popover&gt;\n            @endscope\n        &lt;/x-table&gt;\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"2175,2176","fold":1}},{"content":"Traduction composant Pages","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Add a page\"</span>: <span class=\"hljs-string\">\"Ajouter une page\"</span>,\n<span class=\"hljs-string\">\"Are you sure to delete this page?\"</span>: <span class=\"hljs-string\">\"Êtes-vous sûr de vouloir supprimer cette page ?\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"2245,2246"}}],"payload":{"lines":"2143,2144","fold":1}},{"content":"Composant création pages","children":[{"content":"CLI Creation Pages","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/pages/create --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"2254,2255"}},{"content":"Route Ajouter Pages","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-comment\">// Groupe middleware IsAdminOrRedac &gt; IsAdmin</span>\n<span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/pages/create'</span>, <span class=\"hljs-string\">'admin.pages.create'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'pages.create'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"2260,2261"}},{"content":"Lien Ajouter Pages","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-comment\">// admin.sidebar</span>\n@<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title class_\">Auth</span>::<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isAdmin</span>())\n    &lt;x-menu-sub title=<span class=\"hljs-string\">\"{{ __('Pages') }}\"</span> icon=<span class=\"hljs-string\">\"s-document\"</span>&gt;\n        &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('All pages') }}\"</span> link=<span class=\"hljs-string\">\"{{ route('pages.index') }}\"</span> /&gt;\n        &lt;x-menu-item title=<span class=\"hljs-string\">\"{{ __('Add a page') }}\"</span> link=<span class=\"hljs-string\">\"{{ route('pages.create') }}\"</span> /&gt;\n    &lt;/x-menu-sub&gt;\n@<span class=\"hljs-keyword\">endif</span>\n</code></pre>","children":[]}],"payload":{"lines":"2267,2268"}},{"content":"Formulaire Pages (Création &amp; modification)","children":[{"content":"<pre><code class=\"language-php\">// pages/page-form.blade.php\n&lt;x-card&gt;\n    &lt;x-form wire:submit=\"save\"&gt;\n        &lt;x-input type=\"text\" wire:model=\"title\" label=\"{{ __('Title') }}\"\n            placeholder=\"{{ __('Enter the title') }}\" wire:change=\"$refresh\" /&gt;\n        &lt;x-input type=\"text\" wire:model=\"slug\" label=\"{{ __('Slug') }}\" /&gt;&lt;br&gt;\n        &lt;x-checkbox label=\"{{ __('Published') }}\" wire:model=\"active\" /&gt;&lt;br&gt;\n        &lt;x-editor wire:model=\"body\" label=\"{{ __('Content') }}\" :config=\"config('tinymce.config')\"\n            folder=\"{{ 'photos/' . now()-&gt;format('Y/m') }}\" /&gt;\n        &lt;x-card title=\"{{ __('SEO') }}\" shadow separator&gt;\n            &lt;x-input placeholder=\"{{ __('Title') }}\" wire:model=\"seo_title\" hint=\"{{ __('Max 70 chars') }}\" /&gt;\n            &lt;br&gt;\n            &lt;x-textarea label=\"{{ __('META Description') }}\" wire:model=\"meta_description\"\n                hint=\"{{ __('Max 160 chars') }}\" rows=\"2\" inline /&gt;\n            &lt;br&gt;\n            &lt;x-textarea label=\"{{ __('META Keywords') }}\" wire:model=\"meta_keywords\"\n                hint=\"{{ __('Keywords separated by comma') }}\" rows=\"1\" inline /&gt;\n        &lt;/x-card&gt;\n        &lt;x-slot:actions&gt;\n            &lt;x-button label=\"{{ __('Save') }}\" icon=\"o-paper-airplane\" spinner=\"save\" type=\"submit\"\n                class=\"btn-primary\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-form&gt;\n&lt;/x-card&gt;\n</code></pre>","children":[]}],"payload":{"lines":"2279,2280","fold":1}},{"content":"Code Créer Pages","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\n\nuse App\\Models\\Page;\nuse illuminate\\Support\\Str;\nuse Livewire\\Attributes\\{Layout, Validate, Title};\nuse Livewire\\Volt\\Component;\nuse Mary\\Traits\\Toast;\n\nnew #[Title('Create Page'), Layout('components.layouts.admin')] \nclass extends Component {\n    use Toast;\n    \n    #[Validate('required|max:65000')]\n    public string $body = '';\n    \n    #[Validate('required|max:255')]\n    public string $title = '';\n    \n    #[Validate('required|max:255|unique:posts,slug|regex:/^[a-z0-9]+(?:-[a-z0-9]+)*$/')]\n    public string $slug = '';\n    \n    #[Validate('required')]\n    public bool $active = false;\n    \n    #[Validate('required|max:70')]\n    public string $seo_title = '';\n    \n    #[Validate('required|max:160')]\n    public string $meta_description = '';\n    \n    #[Validate('required|regex:/^[A-Za-z0-9-éèàù]{1,50}?(,[A-Za-z0-9-éèàù]{1,50})*$/')]\n    public string $meta_keywords = '';\n    \n    public function updatedTitle($value): void {\n        $this-&gt;generateSlug($value);\n        $this-&gt;seo_title = $value;\n    }\n    \n    public function save() {\n        $data = $this-&gt;validate();\n        Page::create($data);\n        $this-&gt;success(__('Page added with success.'), redirectTo: '/admin/pages/index');\n    }\n    \n    private function generateSlug(string $title): void {\n        $this-&gt;slug = Str::of($title)-&gt;slug('-');\n    }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header title=\"{{ __('Add a page') }}\" separator progress-indicator&gt;\n        &lt;x-slot:actions class=\"lg:hidden\"&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline\"\n                link=\"{{ route('admin') }}\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n    @include('livewire.admin.pages.page-form')\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"2308,2309","fold":1}},{"content":"Traduction Ajouter Pages","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Page added with success.\"</span>: <span class=\"hljs-string\">\"Page ajoutée avec succès.\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"2371,2372"}},{"content":"Lien ajout Pages","children":[{"content":"<pre><code class=\"language-php\">// pages.index\n&lt;x-button icon=\"c-document-plus\" label=\"{{ __('Add a page') }}\" class=\"btn-outline\" link=\"{{ route('pages.create') }}\" /&gt;\n</code></pre>","children":[]}],"payload":{"lines":"2377,2378"}}],"payload":{"lines":"2252,2253","fold":1}},{"content":"Composant modification (édition) pages","children":[{"content":"CLI édition Pages","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/pages/edit --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"2387,2388"}},{"content":"Route Éditer Pages","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-comment\">// Groupe middleware IsAdminOrRedac &gt; IsAdmin</span>\n<span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/pages/{page:slug}/edit'</span>, <span class=\"hljs-string\">'admin.pages.edit'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'pages.edit'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"2393,2394"}},{"content":"Lien Éditer Pages","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-comment\">// pages.index</span>\n&lt;x-table striped :headers=<span class=\"hljs-string\">\"<span class=\"hljs-subst\">$headers</span>\"</span> :rows=<span class=\"hljs-string\">\"<span class=\"hljs-subst\">$pages</span>\"</span> link=<span class=\"hljs-string\">\"/admin/pages/{slug}/edit\"</span>&gt;\n</code></pre>","children":[]}],"payload":{"lines":"2400,2401"}},{"content":"Code Éditer Pages","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\n\nuse App\\Models\\Page;\nuse illuminate\\Support\\Str;\nuse Illuminate\\Validation\\Rule;\nuse Livewire\\Attributes\\{Layout, Title};\nuse Livewire\\Volt\\Component;\nuse Mary\\Traits\\Toast;\n\nnew #[Title('Edit Page'), Layout('components.layouts.admin')] \nclass extends Component {\n    use Toast;\n    \n    public Page $page;\n    public string $body             = '';\n    public string $title            = '';\n    public string $slug             = '';\n    public bool $active             = false;\n    public string $seo_title        = '';\n    public string $meta_description = '';\n    public string $meta_keywords    = '';\n    \n    public function mount(Page $page): void {\n        $this-&gt;page = $page;\n        $this-&gt;fill($this-&gt;page);\n    }\n    \n    public function updatedTitle($value): void {\n        $this-&gt;generateSlug($value);\n    }\n    \n    public function save() {\n        $data = $this-&gt;validate([\n            'title'            =&gt; 'required|string|max:255',\n            'body'             =&gt; 'required|max:65000',\n            'active'           =&gt; 'required',\n            'slug'             =&gt; ['required', 'string', 'max:255', 'regex:/^[a-z0-9]+(?:-[a-z0-9]+)*$/', Rule::unique('pages')-&gt;ignore($this-&gt;page-&gt;id)],\n            'seo_title'        =&gt; 'required|max:70',\n            'meta_description' =&gt; 'required|max:160',\n            'meta_keywords'    =&gt; 'required|regex:/^[A-Za-z0-9-éèàù]{1,50}?(,[A-Za-z0-9-éèàù]{1,50})*$/',\n        ]);\n    \n        $this-&gt;page-&gt;update($data);\n        \n        $this-&gt;success(__('Page edited with success.'), redirectTo: '/admin/pages/index');\n    }\n    \n    private function generateSlug(string $title): void {\n        $this-&gt;slug = Str::of($title)-&gt;slug('-');\n    }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header title=\"{{ __('Edit a page') }}\" shadow separator progress-indicator&gt;\n        &lt;x-slot:actions class=\"lg:hidden\"&gt;\n            &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline\"\n                link=\"{{ route('admin') }}\" /&gt;\n        &lt;/x-slot:actions&gt;\n    &lt;/x-header&gt;\n    @include('livewire.admin.pages.page-form')\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"2407,2408","fold":1}},{"content":"Traduction Éditer Pages","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Page edited with success.\"</span>: <span class=\"hljs-string\">\"Page mise à jour avec succès.\"</span>,\n<span class=\"hljs-string\">\"Edit a page\"</span>: <span class=\"hljs-string\">\"Modifier une page\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"2473,2474"}}],"payload":{"lines":"2385,2386","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-pages\">https://laravel.sillo.org/posts/mon-cms-les-pages</a></strong></em>","children":[],"payload":{"lines":"2480,2481"}}],"payload":{"lines":"2141,2142","fold":1}},{"content":"Les comptes","children":[{"content":"Composant Comptes","children":[{"content":"CLI Comptes","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/users/edit --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"2486,2487"}},{"content":"Route Comptes","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-comment\">// Groupe middleware IsAdminOrRedac &gt; IsAdmin</span>\n<span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/users/{user}/edit'</span>, <span class=\"hljs-string\">'admin.users.edit'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'users.edit'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"2492,2493"}},{"content":"Lien Comptes","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-comment\">// admin.sidebar</span>\n@<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title class_\">Auth</span>::<span class=\"hljs-title function_ invoke__\">user</span>()-&gt;<span class=\"hljs-title function_ invoke__\">isAdmin</span>())\n    ...\n    &lt;x-menu-item icon=<span class=\"hljs-string\">\"s-user\"</span> title=<span class=\"hljs-string\">\"{{ __('Accounts') }}\"</span> link=<span class=\"hljs-string\">\"{{ route('users.index') }}\"</span> /&gt;\n@<span class=\"hljs-keyword\">endif</span>\n</code></pre>","children":[]}],"payload":{"lines":"2499,2500"}},{"content":"Code Comptes","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\n\nuse App\\Models\\User;\nuse Illuminate\\Pagination\\LengthAwarePaginator;\nuse Livewire\\Attributes\\{Layout, Title};\nuse Livewire\\Volt\\Component;\nuse Livewire\\WithPagination;\nuse Mary\\Traits\\Toast;\n\nnew #[Title('Users'), Layout('components.layouts.admin')] class extends Component {\n    use Toast;\n    use WithPagination;\n    \n    public string $search = '';\n    public array $sortBy  = ['column' =&gt; 'name', 'direction' =&gt; 'asc'];\n    public string $role   = 'all';\n    public array $roles   = [];\n    \n    public function deleteUser(User $user): void {\n        $user-&gt;delete();\n        $this-&gt;success($user-&gt;name . ' ' . __('deleted'));\n    }\n    \n    // Définir les en-têtes de table.\n    public function headers(): array {\n        $headers = [\n            ['key' =&gt; 'name',  'label' =&gt; __('Name')],\n            ['key' =&gt; 'email', 'label' =&gt; 'E-mail'],\n            ['key' =&gt; 'role',  'label' =&gt; __('Role')],\n            ['key' =&gt; 'valid', 'label' =&gt; __('Valid')],\n        ];\n        \n        if ('user' !== $this-&gt;role) {\n            $headers = array_merge($headers, [\n                ['key' =&gt; 'posts_count', 'label' =&gt; __('Posts')],\n            ]);\n        }\n        \n        return array_merge($headers, [\n            ['key' =&gt; 'comments_count', 'label' =&gt; __('Comments')],\n            ['key' =&gt; 'created_at',     'label' =&gt; __('Registration')],\n      ]);\n    }\n    \n    public function users(): LengthAwarePaginator {\n        $query = User::query()\n            -&gt;when($this-&gt;search, fn ($q) =&gt; $q\n                -&gt;where('name', 'like', \"%{$this-&gt;search}%\")\n                -&gt;orWhere('email', 'like', \"%{$this-&gt;search}%\"))\n            -&gt;when('all' !== $this-&gt;role, fn ($q) =&gt; $q\n                -&gt;where('role', $this-&gt;role))\n            -&gt;withCount('posts', 'comments')\n            -&gt;orderBy(...array_values($this-&gt;sortBy));\n        \n        $users = $query-&gt;paginate(10);\n        \n        $userCountsByRole = User::selectRaw('role, count(*) as total')\n            -&gt;groupBy('role')\n            -&gt;pluck('total', 'role');\n        \n        $totalUsers = $userCountsByRole-&gt;sum();\n        \n        $this-&gt;roles = collect([\n            'all'   =&gt; __('All') . \" ({$totalUsers})\",\n            'admin' =&gt; __('Administrators'),\n            'redac' =&gt; __('Redactors'),\n            'user'  =&gt; __('Users'),\n        ])\n        -&gt;map(function ($roleName, $roleId) use ($userCountsByRole) {\n            $count = $userCountsByRole-&gt;get($roleId, 0);\n        \n            return [\n                'name' =&gt; 'all' === $roleId ? $roleName : \"{$roleName} ({$count})\",\n                'id'   =&gt; $roleId,\n            ];\n        })\n        -&gt;values()\n        -&gt;all();\n    \n        return $users;\n    }\n  \n        public function with(): array {\n            return [\n                'users'   =&gt; $this-&gt;users(),\n                'headers' =&gt; $this-&gt;headers(),\n        ];\n    }\n}; ?&gt;\n\n&lt;div&gt;\n    &lt;x-header separator progress-indicator&gt;\n        &lt;x-slot:title&gt;\n            &lt;a href=\"/admin/dashboard\" title=\"{{ __('Back to Dashboard') }}\"&gt;\n                {{ __('Users') }}\n            &lt;/a&gt;\n        &lt;/x-slot:title&gt;\n        &lt;x-slot:middle class=\"!justify-end\"&gt;\n            &lt;x-input placeholder=\"{{ __('Search') }}...\" wire:model.live.debounce=\"search\" clearable\n                icon=\"o-magnifying-glass\" /&gt;\n        &lt;/x-slot:middle&gt;\n    &lt;/x-header&gt;\n\n\n    &lt;x-radio inline :options=\"$roles\" wire:model=\"role\" wire:change=\"$refresh\" /&gt;\n    &lt;br&gt;\n\n    &lt;x-card&gt;\n\n        @if (count($users))\n\n            &lt;x-table striped :headers=\"$headers\" :rows=\"$users\" :sort-by=\"$sortBy\" link=\"/admin/users/{id}/edit\"\n                with-pagination&gt;\n                @scope('cell_name', $user)\n                    &lt;x-avatar :image=\"Gravatar::get($user-&gt;email)\"&gt;\n                        &lt;x-slot:title&gt;\n                            {{ $user-&gt;name }}\n                        &lt;/x-slot:title&gt;\n                    &lt;/x-avatar&gt;\n                @endscope\n                @scope('cell_valid', $user)\n                    @if ($user-&gt;valid)\n                        &lt;x-icon name=\"o-check-circle\" /&gt;\n                    @endif\n                @endscope\n                @scope('cell_role', $user)\n                    @if ($user-&gt;role === 'admin')\n                        &lt;x-badge value=\"{{ __('Administrator') }}\" class=\"badge-error\" /&gt;\n                    @elseif($user-&gt;role === 'redac')\n                        &lt;x-badge value=\"{{ __('Redactor') }}\" class=\"badge-warning\" /&gt;\n                    @elseif($user-&gt;role === 'user')\n                        {{ __('User') }}\n                    @endif\n                @endscope\n                @scope('cell_posts_count', $user)\n                    @if ($user-&gt;posts_count &gt; 0)\n                        &lt;x-badge value=\"{{ $user-&gt;posts_count }}\" class=\"badge-primary\" /&gt;\n                    @endif\n                @endscope\n                @scope('cell_comments_count', $user)\n                    @if ($user-&gt;comments_count &gt; 0)\n                        &lt;x-badge value=\"{{ $user-&gt;comments_count }}\" class=\"badge-success\" /&gt;\n                    @endif\n                @endscope\n                @scope('cell_created_at', $user)\n                    {{ $user-&gt;created_at-&gt;isoFormat('LL') }}\n                @endscope\n                @scope('actions', $user)\n                    &lt;div class=\"flex\"&gt;\n                        &lt;x-popover&gt;\n                            &lt;x-slot:trigger&gt;\n                                &lt;x-button icon=\"o-envelope\" link=\"mailto:{{ $user-&gt;email }}\" no-wire-navigate spinner\n                                    class=\"text-blue-500 btn-ghost btn-sm\" /&gt;\n                            &lt;/x-slot:trigger&gt;\n                            &lt;x-slot:content class=\"pop-small\"&gt;\n                                @lang('Send an email')\n                            &lt;/x-slot:content&gt;\n                        &lt;/x-popover&gt;\n                        &lt;x-popover&gt;\n                            &lt;x-slot:trigger&gt;\n                                &lt;x-button icon=\"o-trash\" wire:click=\"deleteUser({{ $user-&gt;id }})\"\n                                    wire:confirm=\"{{ __('Are you sure to delete this user?') }}\"\n                                    confirm-text=\"Are you sure?\" spinner class=\"text-red-500 btn-ghost btn-sm\" /&gt;\n                            &lt;/x-slot:trigger&gt;\n                            &lt;x-slot:content class=\"pop-small\"&gt;\n                                @lang('Delete')\n                            &lt;/x-slot:content&gt;\n                        &lt;/x-popover&gt;\n                    &lt;/div&gt;\n                @endscope\n            &lt;/x-table&gt;\n        @else\n            &lt;p&gt;@lang('No users with these criteria').&lt;/p&gt;\n        @endif\n\n    &lt;/x-card&gt;\n&lt;/div&gt;\n</code></pre>","children":[]}],"payload":{"lines":"2509,2510","fold":1}},{"content":"Traduction Comptes","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Accounts\"</span>: <span class=\"hljs-string\">\"Comptes\"</span>,\n<span class=\"hljs-string\">\"No users with these criteria\"</span>: <span class=\"hljs-string\">\"Aucun utilisateur avec ces critères\"</span>,\n<span class=\"hljs-string\">\"All\"</span>: <span class=\"hljs-string\">\"Tous\"</span>,\n<span class=\"hljs-string\">\"Administrators\"</span>: <span class=\"hljs-string\">\"Administrateurs\"</span>,\n<span class=\"hljs-string\">\"Redactors\"</span>: <span class=\"hljs-string\">\"Rédacteurs\"</span>,\n<span class=\"hljs-string\">\"Administrator\"</span>: <span class=\"hljs-string\">\"Administrateur\"</span>,\n<span class=\"hljs-string\">\"Redactor\"</span>: <span class=\"hljs-string\">\"Rédacteur\"</span>,\n<span class=\"hljs-string\">\"Role\"</span>: <span class=\"hljs-string\">\"Rôle\"</span>,\n<span class=\"hljs-string\">\"Valid\"</span>: <span class=\"hljs-string\">\"Valide\"</span>,\n<span class=\"hljs-string\">\"Valid user\"</span>: <span class=\"hljs-string\">\"Utilisateur validé\"</span>,\n<span class=\"hljs-string\">\"Send an email\"</span>: <span class=\"hljs-string\">\"Envoyer un email\"</span>,\n<span class=\"hljs-string\">\"Are you sure to delete this user?\"</span>: <span class=\"hljs-string\">\"Êtes-vous sûr de vouloir supprimer cet utilisateur ?\"</span>,\n<span class=\"hljs-string\">\"Registration\"</span>: <span class=\"hljs-string\">\"Inscription\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"2693,2694"}}],"payload":{"lines":"2484,2485","fold":1}},{"content":"Composant Modification Comptes","children":[{"content":"CLI Modification Comptes","children":[{"content":"<pre><code class=\"language-php\">php artisan make:volt admin/users/edit --<span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span>\n</span></code></pre>","children":[]}],"payload":{"lines":"2713,2714"}},{"content":"Route Modification Comptes","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-comment\">// Groupe middleware IsAdminOrRedac &gt; IsAdmin</span>\n<span class=\"hljs-title class_\">Volt</span>::<span class=\"hljs-title function_ invoke__\">route</span>(<span class=\"hljs-string\">'/users/{user}/edit'</span>, <span class=\"hljs-string\">'admin.users.edit'</span>)-&gt;<span class=\"hljs-title function_ invoke__\">name</span>(<span class=\"hljs-string\">'users.edit'</span>);\n</code></pre>","children":[]}],"payload":{"lines":"2719,2720"}},{"content":"Lien Modification Comptes","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-comment\">// Déjà fait dans affichage de la liste (Composant Comptes) :</span>\n<span class=\"hljs-comment\">// (&lt;x-table striped :headers=\"$headers\" :rows=\"$users\" :sort-by=\"$sortBy\" link=\"/admin/users/{id}/edit\" with-pagination&gt;)</span>\n</code></pre>","children":[]}],"payload":{"lines":"2726,2727"}},{"content":"Code Modification Comptes","children":[{"content":"<pre><code class=\"language-php\">&lt;?php\n\n/**\n * (ɔ) Mon CMS - 2024-2024\n */\n\nuse App\\Models\\User;\nuse Illuminate\\Validation\\Rule;\nuse Livewire\\Attributes\\{Layout, Title};\nuse Livewire\\Volt\\Component;\nuse Mary\\Traits\\Toast;\n\nnew #[Title('Edit User'), Layout('components.layouts.admin')]\nclass extends Component {\n    use Toast;\n    \n    public User $user;\n    public string $name  = '';\n    public string $email = '';\n    public string $role  = '';\n    public bool $valid   = false;\n    public bool $isStudent;\n    \n    public function mount(User $user): void {\n        $this-&gt;user = $user;\n        $this-&gt;fill($this-&gt;user);\n    }\n    \n    public function save() {\n        $data = $this-&gt;validate([\n            'name'  =&gt; ['required', 'string', 'max:255'],\n            'email' =&gt; ['required', 'email', Rule::unique('users')-&gt;ignore($this-&gt;user-&gt;id)],\n            'role'  =&gt; ['required', Rule::in(['admin', 'redac', 'user'])],\n            'valid' =&gt; ['required', 'boolean'],\n        ]);\n    \n        $this-&gt;user-&gt;update($data);\n        \n        $this-&gt;success(__('User edited with success.'), redirectTo: '/admin/users/index');\n    }\n    \n    public function with(): array {\n        return [\n            'roles' =&gt; [\n                ['name' =&gt; __('Administrator'), 'id' =&gt; 'admin'],\n                ['name' =&gt; __('Redactor'), 'id' =&gt; 'redac'],\n                ['name' =&gt; __('User'), 'id' =&gt; 'user'],\n            ],\n        ];\n    }\n}; ?&gt;\n\n&lt;div&gt;\n  &lt;x-header title=\"{{ __('Edit an account') }}\" separator progress-indicator&gt;\n    &lt;x-slot:actions&gt;\n      &lt;x-button icon=\"s-building-office-2\" label=\"{{ __('Dashboard') }}\" class=\"btn-outline lg:hidden\"\n        link=\"{{ route('admin') }}\" /&gt;\n    &lt;/x-slot:actions&gt;\n  &lt;/x-header&gt;\n  &lt;x-card&gt;\n    &lt;x-form wire:submit=\"save\"&gt;\n      &lt;x-input label=\"{{ __('Name') }}\" wire:model=\"name\" icon=\"o-user\" inline /&gt;\n      &lt;x-input label=\"{{ __('E-mail') }}\" wire:model=\"email\" icon=\"o-envelope\" inline /&gt;\n      &lt;br&gt;\n      &lt;x-radio label=\"{{ __('User role') }}\" inline label=\"{{ __('Select a role') }}\" :options=\"$roles\"\n        wire:model=\"role\" /&gt;\n      &lt;br&gt;\n      &lt;x-toggle label=\"{{ __('Valid user') }}\" inline wire:model=\"valid\" /&gt;\n      &lt;x-slot:actions&gt;\n        &lt;div class=\"text-right\"&gt;\n          &lt;x-button label=\"{{ __('Save') }}\" icon=\"o-paper-airplane\" spinner=\"save\" type=\"submit\" class=\"btn-primary\" /&gt;\n        &lt;/div&gt;\n      &lt;/x-slot:actions&gt;\n    &lt;/x-form&gt;\n  &lt;/x-card&gt;\n&lt;/div&gt;\n\n</code></pre>","children":[]}],"payload":{"lines":"2733,2734","fold":1}},{"content":"Traduction Modification Comptes","children":[{"content":"<pre><code class=\"language-php\"><span class=\"hljs-string\">\"Edit an account\"</span>: <span class=\"hljs-string\">\"Modifier un compte\"</span>,\n<span class=\"hljs-string\">\"Select a role\"</span>: <span class=\"hljs-string\">\"Sélectionnez un rôle\"</span>,\n<span class=\"hljs-string\">\"User edited with success.\"</span>: <span class=\"hljs-string\">\"Utilisateur mis à jour avec succès.\"</span>\n</code></pre>","children":[]}],"payload":{"lines":"2815,2816"}}],"payload":{"lines":"2711,2712","fold":1}},{"content":"Lien Utilisateurs dans tableau de bord","children":[{"content":"<pre><code class=\"language-php\">// admin/index.blade.php\n@if (Auth::user()-&gt;isAdmin())\n    ...\n    &lt;a href=\"{{ route('users.index') }}\" class=\"flex-grow\"&gt;\n        &lt;x-stat title=\"{{ __('Users') }}\" value=\"{{ $users }}\" icon=\"s-user\" class=\"shadow-hover\" /&gt;\n    &lt;/a&gt;\n@endif\n</code></pre>","children":[]}],"payload":{"lines":"2823,2824","fold":1}},{"content":"Réf.: <em><strong><a href=\"https://laravel.sillo.org/posts/mon-cms-les-comptes#bottom\">https://laravel.sillo.org/posts/mon-cms-les-comptes#bottom</a></strong></em>","children":[],"payload":{"lines":"2835,2836"}}],"payload":{"lines":"2482,2483","fold":1}}],"payload":{"lines":"0,1"}},{"duration":2000,"initialExpandLevel":-1})</script>
</body>
</html>
